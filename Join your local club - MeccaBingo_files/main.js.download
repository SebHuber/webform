MECCA.define("core/helpers/constants",[],function(){"use strict";var e=-1!==(" "+document.documentElement.className+" ").indexOf(" ie8 ");return _.extend({},window.MECCABINGO_CONFIG||{},{PIXEL_SRC:"data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ERRORS:{LOGIN_ERROR:"Sorry we did not recognise the login details you entered. Please try again."},MESSAGES:{LOGIN_PROMPT:"Please confirm your password for security reasons:"},LOGIN_STATUSES:{SUCCESS:0},MAX_COOKIE_EXPIRES_DATE:31536e3,BINGO_ROOM_MAX_TIME:18e4,BINGO_ROOM_HIDE_IN:3e4,BINGO_ROOM_SWITCH_TIME:18e4,BINGO_ROOM_NEXT_GAME_TIME_REFRESH:6e4,DISPLAY_SCREENSHOT_TIME:2e3,DISPLAY_SLIDE_TIME:1e4,TRANSITION_TIME:200,SHOW_DELAY:500,POPUP_PROPERTIES:{width:1040,height:700},BREAKPOINT_LABELS:{MOBILE_SMALL:"mobile-small",MOBILE_REGULAR:"mobile-regular",TABLET:"tablet",DESKTOP:"desktop",MOBILE:["mobile-small","mobile-regular"],TOUCH:["mobile-small","mobile-regular","tablet"]},BREAKPOINTS:{MOBILE_SMALL:{label:"mobile-small",enter:0,exit:e?1:500},MOBILE_REGULAR:{label:"mobile-regular",enter:e?0:501,exit:e?1:725},TABLET:{label:"tablet",enter:e?0:726,exit:e?1:960},DESKTOP:{label:"desktop",enter:e?2:961,exit:99999}},EVENTS:{SHOW_LOGIN_POPUP:"show_login_popup",SHOW_MODAL:"show_modal",SHOW_CONFIRMATION:"show_confirmation",SHOW_WARNING:"show_warning",HIDE_MODAL:"hide_modal",MENU_OPEN:"menu_open",MENU_CLOSE:"menu_close",SHOWN_MODAL:"shown.bs.modal",HIDDEN_MODAL:"hidden.bs.modal",TAB_CHANGE:"tab_change",UPDATE_MODERATORS:"update_moderators"},ARROW_LEFT_KEYCODE:37,ARROW_RIGHT_KEYCODE:39,ARROW_UP_KEYCODE:38,ARROW_DOWN_KEYCODE:40,BINGO_ROOMS_QUANTITY_MOBILE:6,FILTERS:{TYPE:{ALL:"all"},SORT:{AZ:"A-Z",ZA:"Z-A",START_DATE:"StartDate"}},PROMOTION_CATEGORIES:{ALL:"all",BINGO:"Bingo",SLOTS_AND_GAMES:"SlotsAndGames",CLUB:"club",BEST_FOR_YOU:"best_for_you"},THEMES:["nextgen"],GAMEPLAY_MODAL:{SIZE:250,RATIO_X:4,RATIO_Y:3},TEMPLATE_OPTIONS:{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},ALL_SLOTS_ON_PAGE:12,ALL_SLOTS_SORT:"Default",PROMOTION_RELATED_CONTENT_DESKTOP_COUNT:9})}),MECCA.define("core/helpers/utils",["core/helpers/constants","moment"],function(e,t){"use strict";return{parseParam:function(e,t){t||(t=this.getWindowLocation().search);for(var n=t.substring(1).split("&"),i=0;i<n.length;i++){var s=n[i].split("=");if(decodeURIComponent(s[0])===e)return decodeURIComponent(s[1]||"")}return null},noop:function(){},preventDefault:function(e){e.preventDefault()},stopPropagation:function(e){e.stopPropagation()},stopEvent:function(e){this.stopPropagation(e),this.preventDefault(e)},isStateValid:function(e){return/true|false/.test(e)},transitionEnd:function(t,n,i){$.support.transition?(t.one($.support.transition.end,n),t.emulateTransitionEnd(i||e.TRANSITION_TIME)):n()},timer:function(e,t){var n,i,s,o,r,a=!0;return s=function(){a=!1,clearTimeout(n)},r=function(){s(),a=!1,i=new Date,t>=0&&(n=setTimeout(e,t))},o=function(){s(),a=!0,t-=new Date-i},{clear:s,resume:r,pause:o,isPaused:function(){return a}}},getWindowLocation:function(){return window.location},getIOSVersion:function(){return Math.floor(parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||0)||null},createDate:function(e){var n=t.utc(e),i=n.parseZone().zone(),s=n.subtract(i,"minutes");return t.utc(s)},formatHours:function(e,t){return this.formatDate(e,t?"H:mm.ss":"H:mm")},formatDate:function(e,t){return this.createDate(e).format(t||"DD/MM/YYYY")},getCurrentServerTime:function(){var n=t.utc(e.LOAD_SERVER_TIME),i=t(e.LOAD_SERVER_TIME),s=t(e.LOAD_CLIENT_TIME),o=s-i,r=t();return n.add(o+(r-s),"milliseconds")},updateQueryStringParameter:function(e,t,n){n&&(n=encodeURIComponent(n));var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),s=-1!==e.indexOf("?"),o=s?"&":"?";if(e.match(i))return e.replace(i,"$1"+t+"="+n+"$2");var r=e.split("#"),a=r[1];return r[0]+o+t+"="+n+(a?"#"+a:"")},substitute:function(e){if(!_.isString(e))return e;var t=_.rest(arguments),n=e;return _.each(t,function(e,t){var i=new RegExp("\\{"+t+"\\}");n=n.replace(i,e||"")}),n},isReplaceStateSupported:function(){return!(!window.history||!history.replaceState)},isGeolocationSupported:function(){return window.Modernizr.geolocation},createImagesPath:function(t){return this.substitute(e.IMAGES_PATH,t)},getAndroidVersion:function(){var e=navigator.userAgent,t=e.indexOf("Android");return-1!==t?parseFloat(e.slice(t+8))||null:null},compare:function(e,t){return e===t?0:e>t?1:-1},formatMoney:function(e){var t=parseFloat(e.toFixed(2)),n=t.toFixed(2),i=parseInt(t,10)===t,s=t<1&&0!==t;s&&(n=(100*t).toFixed(0)),i&&(n=t.toFixed(0));var o="\\d(?=(\\d{3})+"+(i?"$":"\\D")+")";return s?n+"p":"Â£"+n.replace(new RegExp(o,"g"),"$&,")},getFavoritedGames:function(){$.ajax({type:"GET",url:e.URLS.FAVORITE_GAMES,contentType:"application/json; charset=utf-8",dataType:"json",cache:!1,success:function(e){for(var t=document.getElementsByClassName("js-favorite-action"),n=0;n<e.length;n++)for(var i=0;i<t.length;i++)t[i].getAttribute("data-favorite-id")===e[n]&&(t[i].className+=" selected")}})},getFavoritedGamesForSorting:function(){return $.get(e.URLS.FAVORITE_GAMES)},getFavoritedRooms:function(){$.ajax({type:"GET",url:e.URLS.FAVORITE_ROOMS,contentType:"application/json; charset=utf-8",dataType:"json",cache:!1,success:function(e){for(var t=document.getElementsByClassName("js-favorite-action"),n=0;n<e.length;n++)for(var i=0;i<t.length;i++)t[i].getAttribute("data-favorite-id")===e[n]&&(t[i].className+=" selected")}})}}}),MECCA.define("core/helpers/mixins",["core/helpers/utils","core/helpers/constants"],function(e,t){"use strict";var n={applyResizeFixer:function(e){var t=e._resizeFixerId=_.uniqueId(".mixins-resize-"),n=$(window),i=_.debounce(function(){_.isFunction(e.resizeFix)&&e.resizeFix()},10);n.on("resize"+t,i)},destroyResizeFixer:function(e){$(window).off("resize"+e._resizeFixerId),e._resizeFixerId=null},doToggleActionWithElement:function(e,t){var n=function(){e.find("[data-toggle-action-hide]").addClass("l-none"),e.find("[data-toggle-action-show]").removeClass("l-none")};_.delay(n,t)},generateAdvancedLink:function(t){if(!_.isObject(t)||!t.Action&&!t.Url)return"";var n,i=['onclick="'+(t.Action||"javascript:void(0);")+'"','href="'+(t.Url||"javascript:void(0);")+'"',t.ClassName,t.Title,t.Attributes,t.Text];switch(t.LinkType){case"Popup":n='<a {0} {1} class="js-open-in-popup {2}" title="{3}" {4}>{5}</a>';break;case"NewWindow":n='<a {0} {1} target="_blank" class="{2}" title="{3}" {4}>{5}</a>';break;default:n='<a {0} {1} class="{2}" title="{3}" {4}>{5}</a>'}return e.substitute.apply(e,[n].concat(i))},updateUrl:function(t,n){if(e.isReplaceStateSupported()){var i=e.getWindowLocation().href,s=e.updateQueryStringParameter(i,t,n||"");history.replaceState(null,null,s)}},getLineItems:function(e,t){var n,i,s,o=e.eq(t),r=[o];if(o.length){for(s=o.offset().top,i=function(){var n=e.eq(t+r.length);if(n.length&&s===n.offset().top)return n};void 0!==(n=i());)r.push(n);return r}},fixLineItemsHeight:function(e){var t=this.getLineItems,n=function(e){var i=t(e,0);if(i){var s=_.max(_.map(i,function(e){return $(e).height()}));_.each(i,function(e){$(e).height(s)}),n(e.slice(i.length))}};n(e.filter(":visible").height("auto"))},runHeightFixerOnClosest:function(e){var t=e.closest("[data-fix-height-of]");t.length&&_.isFunction(t.heightFixer)&&t.heightFixer("fix")},renderLinkHelper:function(e,t){return this.generateAdvancedLink(_.extend(_.clone(e||{}),t))},generateCTA:function(e,t){if(t||(t={}),!_.isObject(e))return null;var n=e,i=n&&n.Width||0,s=n&&n.Height||0;return t.ClassName=[t.ClassName||"","btn"].join(" "),t.Attributes=[t.Attributes||"",'data-popup-width="'+i+'" data-popup-height="'+s+'"'].join(" "),_.isObject(n.Link)&&(n=n.Link),n&&n.NeedRendering?this.renderLinkHelper(n,t):null},highlightStr:function(e,t){if(e||(e=""),t||(t=[]),_.isEmpty(t))return e;var n=_.sortBy(t,"length").reverse(),i="("+n.join("|")+")",s=new RegExp(i,"gi");return e.replace(s,'<span class="search-result-matched">$1</span>')},fixClickHandler:function(t){var n,i=e.getAndroidVersion();return!i||i<4?t:function(){var e=+new Date;(e-n>400||!n)&&(n=e,t.apply(null,arguments))}},createTemplateFunction:function(e,n){var i=e.html()||"",s=n?$.trim(i):i;return _.template(s,null,t.TEMPLATE_OPTIONS)},canHaveOverflow:function(){var t=e.getAndroidVersion();return!t||t>=3},isScrolledIntoView:function(e){var t=$(window),n=t.scrollTop(),i=n+t.height(),s=e.offset().top;return s+e.height()<=i&&s>=n}};return window.mixins=n,$(document).trigger("mixinsAdded"),n}),function(){"use strict";function e(t,i){var s;if(i=i||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=i.touchBoundary||10,this.layer=t,this.tapDelay=i.tapDelay||200,this.tapTimeout=i.tapTimeout||700,!e.notNeeded(t)){for(var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],r=this,a=0,c=o.length;a<c;a++)r[o[a]]=function(e,t){return function(){return e.apply(t,arguments)}}(r[o[a]],r);n&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,i){var s=Node.prototype.removeEventListener;"click"===e?s.call(t,e,n.hijacked||n,i):s.call(t,e,n,i)},t.addEventListener=function(e,n,i){var s=Node.prototype.addEventListener;"click"===e?s.call(t,e,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),i):s.call(t,e,n,i)}),"function"==typeof t.onclick&&(s=t.onclick,t.addEventListener("click",function(e){s(e)},!1),t.onclick=null)}}var t=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!t,i=/iP(ad|hone|od)/.test(navigator.userAgent)&&!t,s=i&&/OS 4_\d(_\d)?/.test(navigator.userAgent),o=i&&/OS [6-7]_\d/.test(navigator.userAgent),r=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(i&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},e.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},e.prototype.sendClick=function(e,t){var n,i;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),i=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},e.prototype.determineEventType=function(e){return n&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},e.prototype.focus=function(e){var t;i&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},e.prototype.updateScrollParent=function(e){var t,n;if(!(t=e.fastClickScrollParent)||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},e.prototype.onTouchStart=function(e){var t,n,o;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],i){if(o=window.getSelection(),o.rangeCount&&!o.isCollapsed)return!0;if(!s){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},e.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n},e.prototype.onTouchMove=function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)},e.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(e){var t,r,a,c,u,l=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,r=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,o&&(u=e.changedTouches[0],l=document.elementFromPoint(u.pageX-window.pageXOffset,u.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(a=l.tagName.toLowerCase())){if(t=this.findControl(l)){if(this.focus(l),n)return!1;l=t}}else if(this.needsFocus(l))return e.timeStamp-r>100||i&&window.top!==window&&"input"===a?(this.targetElement=null,!1):(this.focus(l),this.sendClick(l,e),i&&"select"===a||(this.targetElement=null,e.preventDefault()),!1);return!(!i||s||!(c=l.fastClickScrollParent)||c.fastClickLastScrollTop===c.scrollTop)||(this.needsClick(l)||(e.preventDefault(),this.sendClick(l,e)),!1)},e.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(e){return!this.targetElement||(!!e.forwardedTouchEvent||(!e.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))))},e.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail||(t=this.onMouse(e),t||(this.targetElement=null),t)},e.prototype.destroy=function(){var e=this.layer;n&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(e){var t,i,s;if(void 0===window.ontouchstart)return!0;if(i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(i>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(r&&(s=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),s[1]>=10&&s[2]>=3&&(t=document.querySelector("meta[name=viewport]")))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(t=document.querySelector("meta[name=viewport]"))&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===e.style.touchAction||"manipulation"===e.style.touchAction))},e.attach=function(t,n){return new e(t,n)},"function"==typeof MECCA.define&&"object"==typeof MECCA.define.amd&&MECCA.define.amd?MECCA.define("vendor/fastclick",[],function(){return e}):"undefined"!=typeof module&&module.exports?(module.exports=e.attach,module.exports.FastClick=e):window.FastClick=e}(),MECCA.define("core/responsive",["core/helpers/constants","jRespond","vendor/fastclick"],function(e,t,n){"use strict";var i=function(){this.respond=t(_.values(e.BREAKPOINTS))};return i.prototype={_breakpoints:{},_wrapBreakpoint:function(e){return _.wrap(e,_.bind(function(e,t){t.entering&&(this._breakpoints[t.entering]=!0),t.exiting&&(this._breakpoints[t.exiting]=!1),e()},this))},attachFastlick:function(e){e&&n.attach(e)},registerBreakpoint:function(e,t,n){var i={breakpoint:e,enter:this._wrapBreakpoint(t),exit:this._wrapBreakpoint(n)};return this.respond.addFunc(i),i},removeBrekpoint:function(e){this.respond.removeFunc(e)},is:function(e){var t=this._breakpoints,n=function(e){return!!t[e]};return _.isArray(e)?_.some(_.map(e,n)):n(e)},isMobileMode:function(){return this.isMobileSmallMode()||this.isMobileRegularMode()},isMobileSmallMode:function(){return this.is(e.BREAKPOINTS.MOBILE_SMALL.label)},isMobileRegularMode:function(){return this.is(e.BREAKPOINTS.MOBILE_REGULAR.label)},isTabletMode:function(){return this.is(e.BREAKPOINTS.TABLET.label)},isTouchMode:function(){return this.isMobileMode()||this.isTabletMode()},isDesktopMode:function(){return this.is(e.BREAKPOINTS.DESKTOP.label)}},i}),function(e,t){"use strict";"object"==typeof exports&&module?module.exports=t():"function"==typeof MECCA.define&&MECCA.define.amd?MECCA.define("vendor/pubsub",t):e.PubSub=t()}("object"==typeof window&&window||this,function(){"use strict";function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function t(e){return function(){throw e}}function n(e,n,i){try{e(n,i)}catch(e){setTimeout(t(e),0)}}function i(e,t,n){e(t,n)}function s(e,t,s,o){var r,a=u[t],c=o?i:n;if(u.hasOwnProperty(t))for(r in a)a.hasOwnProperty(r)&&c(a[r],e,s)}function o(e,t,n){return function(){var i=String(e),o=i.lastIndexOf(".");for(s(e,e,t,n);-1!==o;)i=i.substr(0,o),o=i.lastIndexOf("."),s(e,i,t)}}function r(t){for(var n=String(t),i=Boolean(u.hasOwnProperty(n)&&e(u[n])),s=n.lastIndexOf(".");!i&&-1!==s;)n=n.substr(0,s),s=n.lastIndexOf("."),i=Boolean(u.hasOwnProperty(n)&&e(u[n]));return i}function a(e,t,n,i){var s=o(e,t,i);return!!r(e)&&(!0===n?s():setTimeout(s,0),!0)}var c={},u={},l=-1;return c.publish=function(e,t){return a(e,t,!1,c.immediateExceptions)},c.publishSync=function(e,t){return a(e,t,!0,c.immediateExceptions)},c.subscribe=function(e,t){if("function"!=typeof t)return!1;u.hasOwnProperty(e)||(u[e]={});var n="uid_"+String(++l);return u[e][n]=t,n},c.unsubscribe=function(e){var t,n,i,s="string"==typeof e,o=!1;for(t in u)if(u.hasOwnProperty(t)){if(n=u[t],s&&n[e]){delete n[e],o=e;break}if(!s)for(i in n)n.hasOwnProperty(i)&&n[i]===e&&(delete n[i],o=!0)}return o},c}),function(e){"use strict";var t=function(e,n,i){return 1===arguments.length?t.get(e):t.set(e,n,i)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(e,n,i){return i=t._getExtendedOptions(i),i.expires=t._getExpiresDate(void 0===n?-1:i.expires),t._document.cookie=t._generateCookieString(e,n,i),t},t.expire=function(e,n){return t.set(e,void 0,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&void 0!==e.secure?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var i=e+"="+t;return i+=n.path?";path="+n.path:"",i+=n.domain?";domain="+n.domain:"",i+=n.expires?";expires="+n.expires.toUTCString():"",i+=n.secure?";secure":""},t._getCookieObjectFromString=function(e){for(var n={},i=e?e.split("; "):[],s=0;s<i.length;s++){var o=t._getKeyValuePairFromCookieString(i[s]);void 0===n[o.key]&&(n[o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="1"===t.set("cookies.js",1).get("cookies.js");return t.expire("cookies.js"),e},t.enabled=t._areEnabled(),"function"==typeof MECCA.define&&MECCA.define.amd?MECCA.define("vendor/cookies",[],function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}(),function(){function e(){}function t(e){return o.retinaImageSuffix+e}function n(e,n){if(this.path=e||"",void 0!==n&&null!==n)this.at_2x_path=n,this.perform_check=!1;else{if(void 0!==document.createElement){var i=document.createElement("a");i.href=this.path,i.pathname=i.pathname.replace(r,t),this.at_2x_path=i.href}else{var s=this.path.split("?");s[0]=s[0].replace(r,t),this.at_2x_path=s.join("?")}this.perform_check=!0}}function i(e){this.el=e,this.path=new n(this.el.getAttribute("src"),this.el.getAttribute("data-at2x"));var t=this;this.path.check_2x_variant(function(e){e&&t.swap()})}var s="undefined"==typeof exports?window:exports,o={retinaImageSuffix:"@2x",check_mime_type:!0,force_original_dimensions:!0};s.Retina=e,e.configure=function(e){null===e&&(e={});for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t])},e.init=function(e){null===e&&(e=s);var t=e.onload||function(){};e.onload=function(){var e,n,s=document.querySelectorAll("img[data-retina]"),o=[];for(e=0;e<s.length;e+=1)n=s[e],o.push(new i(n));t()}},e.isRetina=function(){return s.devicePixelRatio>1||!(!s.matchMedia||!s.matchMedia("(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)").matches)};var r=/\.\w+$/;s.RetinaImagePath=n,n.confirmed_paths=[],n.prototype.is_external=function(){return!(!this.path.match(/^https?\:/i)||this.path.match("//"+document.domain))},n.prototype.check_2x_variant=function(e){var t,i=this;return this.is_external()?e(!1):this.perform_check||void 0===this.at_2x_path||null===this.at_2x_path?this.at_2x_path in n.confirmed_paths?e(!0):(t=new XMLHttpRequest,t.open("HEAD",this.at_2x_path),t.onreadystatechange=function(){if(4!==t.readyState)return e(!1);if(t.status>=200&&t.status<=399){if(o.check_mime_type){var s=t.getResponseHeader("Content-Type");if(null===s||!s.match(/^image/i))return e(!1)}return n.confirmed_paths.push(i.at_2x_path),e(!0)}return e(!1)},t.send(),void 0):e(!0)},s.RetinaImage=i,i.prototype.swap=function(e){function t(){n.el.complete?(o.force_original_dimensions&&(n.el.setAttribute("width",n.el.offsetWidth),n.el.setAttribute("height",n.el.offsetHeight)),n.el.setAttribute("src",e)):setTimeout(t,5)}void 0===e&&(e=this.path.at_2x_path);var n=this;t()},e.isRetina()&&e.init(s)}(),MECCA.define("vendor/retina",function(){}),MECCA.define("app",["core/helpers/constants","core/helpers/utils","core/helpers/mixins","core/responsive","vendor/pubsub","vendor/cookies","vendor/retina"],function(e,t,n,i,s,o){"use strict";return o.defaults.domain=e.DOMAIN_NAME,{constants:e,utils:t,mixins:n,responsive:new i,pubsub:s}}),MECCA.define("core/helpers/extend",[],function(){"use strict";return function(e){var t,n=this;t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return n.apply(this,arguments)},_.extend(t,n);var i=function(){this.constructor=t};return i.prototype=n.prototype,t.prototype=new i,e&&_.extend(t.prototype,e),t}}),MECCA.define("core/components/_component.export",["app","core/helpers/extend"],function(e,t){"use strict";var n=function(){this.createDefaults(),this.initializeComponents()};return n.prototype={createDefaults:function(){this.components||(this.components=[]),this._componentsInstances=[]},initializeComponents:function(){_.each(this.components||[],this.initializeComponent,this)},initializeComponent:function(e,t){var n=[];_.isObject(e)&&!_.isFunction(e)&&(n=e.args||[],e=e.component),_.isObject(this.componentOptions)&&(n[0]=_.defaults(n[0]||{},this.componentOptions)),this._componentsInstances[t]=new(_.bind.apply(_,[e,e].concat(n)))}},n.prototype.constructor=n,n.extend=function(e){return t.call(this,e)},n}),MECCA.define("core/components/_component",["app","core/helpers/extend"],function(e,t){"use strict";var n=function(){this._bindAll(),this.initialize.apply(this,arguments),this._registerBreakpoints()};return n.prototype={_bindAll:function(){_.isArray(this.bindAll)&&_.bindAll.apply(_,[this].concat(this.bindAll))},_registerBreakpoints:function(){var t=_.bind(this.onEnter||e.utils.noop,this),n=_.bind(this.onExit||e.utils.noop,this),i=this.type;i&&(this._breakpoint=e.responsive.registerBreakpoint(i,t,n))},_breakpoint:null,type:null,initialize:function(){},destroy:function(){var t=this._breakpoint;t&&(e.responsive.is(t.breakpoint)&&t.exit({}),e.responsive.removeBrekpoint(t))}},n.prototype.constructor=n,n.extend=function(e){return t.call(this,e)},n}),MECCA.define("core/components/common/common.all",["app","core/components/_component"],function(e,t){"use strict";return t.extend({bindAll:["needsLoginClickHandler","openInPopupClickHandler","stopPropagationClickHandler","documentKeydownHandler"],initialize:function(){this.cacheElements(),this.addListeners(),this.setupAjax(),this.addDeviceSpecificClasses()},cacheElements:function(){this.$document=$(document),this.$documentElement=$(document.documentElement)},addListeners:function(){this.$document.on("click.component:common:all",".js-needs-login",this.needsLoginClickHandler),this.$document.on("click.component:common:all",".js-open-in-popup",this.openInPopupClickHandler),this.$document.on("click.component:common:all",".js-stop-propagation",this.stopPropagationClickHandler),this.$document.on("keydown.component:common:all",this.documentKeydownHandler)},documentKeydownHandler:function(e){e.shiftKey&&e.ctrlKey&&85===e.which&&this.$documentElement.toggleClass("grayscale")},needsLoginClickHandler:function(t){e.utils.preventDefault(t),e.pubsub.publish(e.constants.EVENTS.SHOW_LOGIN_POPUP)},openInPopupClickHandler:function(t){var n=t.currentTarget,i=n.href||n.getAttribute("data-href")||n.getAttribute("data-gameurl");if(i&&0!==i.indexOf("javascript:")){e.utils.preventDefault(t);var s=$(t.target).data();s.gameurl=i;var o="/gameslogin?"+this.buildPopUpQueryString(s);window.open(o,"_blank",this.getPopupProperties({width:+n.getAttribute("data-popup-width")||void 0,height:+n.getAttribute("data-popup-height")||void 0,resizable:"yes"}))}},buildPopUpQueryString:function(e){return Object.keys(e).map(function(t){return[t,encodeURIComponent(e[t])].join("=")}).join("&")},stopPropagationClickHandler:function(t){e.utils.stopPropagation(t)},getPopupProperties:function(t){var n=_.defaults(t,e.constants.POPUP_PROPERTIES);return _.invoke(_.pairs(n),"join","=").join(",")},setupAjax:function(){$.ajaxSetup({cache:!1}),$(document).ajaxComplete(this.onAjaxComplete)},onAjaxComplete:function(e,t){t.status},addDeviceSpecificClasses:function(){this.addAndroidClass()},addAndroidClass:function(){/Android/i.test(navigator.userAgent)&&this.addDocumentClass("android")},addDocumentClass:function(e){this.$documentElement.addClass(e)}})}),MECCA.define("core/components/common/session-caretaker.all",["app","core/components/_component","vendor/cookies","moment"],function(e,t,n,i){"use strict";return t.extend({initialize:function(){this.defineProperties(),this.setTimeoutOrReload(!1)},defineProperties:function(){this.localAndServerDifference=this.getLocalAndServerDifference()},setSessionTimeout:function(e){_.delay(_.bind(this.setTimeoutOrReload,this),e,!0)},setTimeoutOrReload:function(e){var t=this.getSessionLeft();t?this.setSessionTimeout(t):e&&this.reloadPage()},reloadPage:function(){window.location.reload()},getSessionLeft:function(){var e=this.getSessionExpiredTime();return!!(e&&e>new Date)&&this.calculateTimeLeft(e)},getSessionExpiredTime:function(){return i(n.get(this.getCookieName()))},calculateTimeLeft:function(e){return e-i().diff(this.localAndServerDifference)},getLocalAndServerDifference:function(){return i().diff(this.getServerTime())},getServerTime:function(){return e.constants.LOAD_SERVER_TIME},getCookieName:function(){return e.constants.COOKIES.SESSION_LEFT_COOKIE_NAME}})}),MECCA.define("core/services/_service",["app","core/helpers/extend"],function(e,t){"use strict";var n=function(){this._checkURL()};return n.prototype={_fetching:!1,_setFetching:function(e){this._fetching=e},_checkURL:function(){if(!_.isString(this.url))throw new Error("Please specify an URL")},isFetching:function(){return this._fetching},makeRequestWithUrl:function(e,t,n){var i,s=this.url;return this.url=e,i=t.call(this,n),this.url=s,i},makeAJAX:function(e,t){if(t=t||{},"POST"===e.toUpperCase()){var n=document.querySelector('meta[name="csrf-token"]'),i=n?n.getAttribute("content"):"";t.headers=t.headers||{},t.headers["X-CSRF-Token"]=i}return $.ajax(_.extend(t,{url:this.url,type:e,complete:_.bind(this._setFetching,this,!1)}))},fetch:function(){return this._checkURL(),this._setFetching(!0),this.makeAJAX.apply(this,arguments)},get:function(e){return this.fetch("get",e)},post:function(e){return this.fetch("post",e)}},n.extend=function(e){return t.call(this,e)},n}),MECCA.define("core/services/balance.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.BALANCE})}),MECCA.define("core/services/bingo-mini-schedule.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.BINGO_MINI_SCHEDULE})}),MECCA.define("core/services/next-game.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.BINGO_NEXT_GAME})}),MECCA.define("core/services/winner-feeds.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.WINNERS_FEEDS})}),MECCA.define("core/services/slots-and-games.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.SLOTS_AND_GAMES,getSimilar:function(){return this.url=e.constants.URLS.SLOTS_AND_GAMES_SIMILAR,this},getDefault:function(){return this.url=e.constants.URLS.SLOTS_AND_GAMES,this}})}),MECCA.define("core/services/all-slots-and-games.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.ALL_SLOTS_AND_GAMES})}),MECCA.define("core/services/related-rooms.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.RELATED_BINGO_ROOMS})}),MECCA.define("core/services/promotion-related.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.PROMOTION_RELATED_ROOMS_AND_GAMES})}),MECCA.define("core/services/clubs-list.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.CLUBS_LIST})}),MECCA.define("core/services/club-details.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.CLUB_DETAILS})}),
MECCA.define("core/services/favorite.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:null,constructor:function(){},favorite:function(t,n){switch(t){case"club":this.url=e.constants.URLS.FAVORITE_CLUB;break;case"game":this.url=e.constants.URLS.FAVORITE_GAME;break;case"room":this.url=e.constants.URLS.FAVORITE_ROOM;break;default:return null}return this.post(n)},unfavourite:function(t,n){switch(t){case"club":this.url=e.constants.URLS.FAVORITE_CLUB;break;case"game":this.url=e.constants.URLS.FAVORITE_GAME;break;case"room":this.url=e.constants.URLS.FAVORITE_ROOM;break;default:return null}return this.post(n)},all:function(t){return this.url=e.constants.URLS.ALL_FAVOURITES,this.get(t)},setConfirmationMessageValue:function(t){return this.url=e.constants.URLS.SET_SHOWCONFIRMATION_MESSAGES_VALUE,this.post(t)}})}),MECCA.define("core/services/user-favourites.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.USER_FAVOURITES})}),MECCA.define("core/services/schedule.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:null,constructor:function(){},getPlayNow:function(){return this.url=e.constants.URLS.SCHEDULE_PLAY_NOW,this.get({data:{maxGamesPerRoom:2}})},getPreBuy:function(t){return this.url=e.constants.URLS.SCHEDULE_PREBUY,this.post(t)}})}),MECCA.define("core/services/mobile-apps-info.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.MOBILE_APP_INFO})}),MECCA.define("core/services/my-account-messages.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.MY_ACCOUNT_MESSAGES})}),MECCA.define("core/services/search.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.SEARCH})}),MECCA.define("core/services/moderator.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.MODERATOR_DETAILS,voteUrl:e.constants.URLS.MODERATOR_VOTE,vote:function(e){return this.makeRequestWithUrl(this.voteUrl,this.post,e)}})}),MECCA.define("core/services/times-and-prices.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.TIMES_AND_PRICES})}),MECCA.define("core/services/find-address.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.FIND_ADDRESS})}),MECCA.define("core/services/find-address-details.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.FIND_ADDRESS_DETAILS})}),MECCA.define("core/services/purchase-details.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.PURCHASE_DETAILS})}),MECCA.define("core/services/buy-tickets.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.BUY_TICKETS})}),MECCA.define("core/services/accept-cookies.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.ACCEPT_COOKIES})}),MECCA.define("core/services/schedule-max.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.SCHEDULE_MAX})}),MECCA.define("core/services/schedule-paper.service",["app","core/services/_service"],function(e,t){"use strict";return t.extend({url:e.constants.URLS.SCHEDULE_PAPER})}),MECCA.define("services",["core/services/balance.service","core/services/bingo-mini-schedule.service","core/services/next-game.service","core/services/winner-feeds.service","core/services/slots-and-games.service","core/services/all-slots-and-games.service","core/services/related-rooms.service","core/services/promotion-related.service","core/services/clubs-list.service","core/services/club-details.service","core/services/favorite.service","core/services/user-favourites.service","core/services/schedule.service","core/services/mobile-apps-info.service","core/services/my-account-messages.service","core/services/search.service","core/services/moderator.service","core/services/times-and-prices.service","core/services/find-address.service","core/services/find-address-details.service","core/services/purchase-details.service","core/services/buy-tickets.service","core/services/accept-cookies.service","core/services/schedule-max.service","core/services/schedule-paper.service"],function(e,t,n,i,s,o,r,a,c,u,l,h,d,p,f,m,v,g,E,S,C,b,_,T,w){"use strict";return{balanceService:new e,bingoMiniScheduleService:new t,nextGameService:new n,winnerFeedsService:new i,slotsAndGamesService:new s,allSlotsAndGamesService:new o,relatedRoomsService:new r,promotionRelatedService:new a,clubsListService:new c,clubDetailsService:new u,favoriteService:new l,userFavouritesService:new h,scheduleService:new d,mobileAppsInfoService:new p,myAccountMessagesService:new f,searchService:new m,moderatorService:new v,timesAndPricesService:new g,findAddressService:new E,findAddressDetailsService:new S,purchaseDetailsServise:new C,buyTickets:new b,acceptCookies:new _,scheduleMax:new T,schedulePaper:new w}}),MECCA.define("core/components/common/favorite.all",["app","core/components/_component","services"],function(e,t,n){"use strict";var i=e.constants.WARNING_MESSAGES;return t.extend({bindAll:["favoriteClickHandler","unfavoriteClickHandler","onCustomFavoriteEventHandler"],showConfirmation:e.constants.SHOW_CONFIRMATION_MESSAGES,selectors:{favouriteElement:".favorite-element",unfavorite:".js-unfavorite-action",favorite:".js-favorite-action"},confirmationMessages:{club:i.RemoveClubFavoritesMessage,game:i.RemoveGameFavoritesMessage,room:i.RemoveBingoRoomFavoritesMessage},favoriteMessages:{club:i.AddClubFavoritesMessage,game:i.AddGameFavoritesMessage,room:i.AddBingoFavoritesMessage},postLoginTypesMap:{club:"Club",game:"Game",room:"Room"},favourites:{FavoriteRooms:[],FavoriteGames:[],FavoriteClub:!1},initialize:function(){this.cacheElements(),this.addListeners(),this.getFavourites(),this.updateFavouriteElements()},cacheElements:function(){this.$document=$(document.body)},addListeners:function(){this.$document.on("click",this.selectors.favorite,this.favoriteClickHandler),this.$document.on("click",this.selectors.unfavorite,this.unfavoriteClickHandler),e.pubsub.subscribe("custom.favorite.event",this.onCustomFavoriteEventHandler)},onCustomFavoriteEventHandler:function(e,t){this.favoriteItem(t.type,t.id,t.isFavorite,t.isFavoriting)},favoriteClickHandler:function(t){e.utils.preventDefault(t),this.favoriteElement(t.currentTarget)},unfavoriteClickHandler:function(t){e.utils.preventDefault(t)},getFavourites:function(){return e.constants.LOGGED_IN_HARD&&(this.favourites=n.favoriteService.all({async:!1}).responseJSON),this.favourites},updateFavouriteElements:function(){var e=this,t=[];if(_.each(this.favourites.FavoriteRooms,function(n){var i=e.selectors.favouriteElement+'[data-favorite-type="room"][data-favorite-id="'+n+'"]';t.push(i)}),_.each(this.favourites.FavoriteGames,function(n){var i=e.selectors.favouriteElement+'[data-favorite-type="game"][data-favorite-id="'+n+'"]';t.push(i)}),this.favourites.FavoriteClub){var n=e.selectors.favouriteElement+'[data-favorite-type="club"][data-favorite-id="'+this.favourites.FavoriteClub+'"]';t.push(n)}$(this.selectors.favouriteElement).not(t.join(", ")).removeClass("js-unfavorite-action selected"),$(t.join(", ")).addClass("js-unfavorite-action selected")},getClubs:function(){return n.clubsListService.get({async:!1}).responseJSON},getClub:function(e){return _.findWhere(this.getClubs(),{ClubNumber:parseInt(e,10)})},getFavoritedClub:function(){return this.getClub(this.favourites.FavoriteClub)},hasFavoritedClub:function(){return!!this.getFavoritedClub()},isFavoritedClub:function(e){return!!this.getFavoritedClub()&&parseInt(this.getFavoritedClub().ClubNumber,10)===parseInt(e,10)},favoriteElement:function(e){var t=$(e),n=t.data("favorite-type"),i=t.data("favorite-id").toString(),s=t.data("favorite-class"),o=t.hasClass(s),r=t.hasClass("favoriting");this.favoriteItem(n,i,o,r)},favoriteItem:function(e,t,n,i){var s={favoriteType:e,favoriteId:t};e&&t&&!i&&(n&&this.canFavorite()?this.unfavorite(_.extend(s,{isFavorite:!1})):this.favorite(_.extend(s,{isFavorite:!0})))},favorite:function(e){this.canFavorite()?this.proceedFavorite(e):this.requestLogin(e)},unfavorite:function(e){this.showConfirmation?this.askRemoveConfirmation(e):this.saveFavorite(e)},proceedFavorite:function(e){"club"===e.favoriteType?this.askConfirmation(e,this.getFavoriteMessage(e),!1):this.saveFavorite(e)},saveFavorite:function(e){var t=e.favoriteType,i=this.getServiceOptions(e),s=n.favoriteService.favorite(t,i);s&&(this.toggleFavoritingForAllWithType(e,!0),s.done(_.bind(this.onSaveDone,this,e)).fail(_.bind(this.onSaveFail,this,e)).always(_.bind(this.onSaveComplete,this,e)))},saveConfirmationState:function(e){var t=n.favoriteService.setConfirmationMessageValue({data:{value:this.showConfirmation}});t&&t.always(_.bind(this.saveFavorite,this,e))},canFavorite:function(){return e.constants.LOGGED_IN_HARD||e.constants.LOGGED_IN_SOFT},askRemoveConfirmation:function(e){this.askConfirmation(e,this.getRemoveConfirmationMessage(e))},askConfirmation:function(t,n,i){var s;n&&(s=_.bind(this.saveConfirmationAndFavorite,this,t),e.pubsub.publish(e.constants.EVENTS.SHOW_CONFIRMATION,{message:n,remebmer:!_.isBoolean(i)||i,yes:{callback:s}}))},saveConfirmationAndFavorite:function(t,n){e.utils.isStateValid(n)?(this.showConfirmation=!n,n&&this.saveConfirmationState(t),!1===n&&this.saveFavorite(t)):this.saveFavorite(t)},getRemoveConfirmationMessage:function(e){return this.confirmationMessages[e.favoriteType]},getFavoriteMessage:function(e){switch(e.favoriteType){case"club":return this.getClubFavoriteMessage(e);default:return this.favoriteMessages[e.favoriteType]}},getClubFavoriteMessage:function(e){var t=this.getFavoritedClub(),n=this.getClub(e.favoriteId),s=(t&&t.ClubNumber?i.ReplaceClubFavoritesMessage:i.AddClubFavoritesMessage)||"",o=[];return t&&t.ClubNumber&&t.ClubNumber!==n.ClubNumber?(o.push(["#club1#",t.Name]),o.push(["#club2#",n.Name])):o.push(["#club1#",n.Name]),_.each(o,function(e){s=s.replace.apply(s,e)}),s},requestLogin:function(t){e.pubsub.publish(e.constants.EVENTS.SHOW_LOGIN_POPUP,{prompt:this.getFavoriteMessage(t),serviceOptions:{SetUserPreferencesJson:JSON.stringify(this.createPostLoginData(t))}})},createPostLoginData:function(e){var t={};return t[this.postLoginTypesMap[e.favoriteType]]={FavoriteId:e.favoriteId,IsFavorite:e.isFavorite},{Favorites:t}},getServiceOptions:function(e){return{data:{favoriteId:e.favoriteId,isFavorite:e.isFavorite}}},onSaveDone:function(e){this.toggleFavoriteForAllWithType(e,e.isFavorite),this.triggerSuccessfulFavoriteAction(e)},onSaveFail:function(e,t){this.toggleFavoriteForAllWithType(e,!e.isFavorite),this.showFavoriteError(t)},onSaveComplete:function(e){this.toggleFavoritingForAllWithType(e,!1)},getTheClones:function(e){var t='[data-favorite-type="'+e.favoriteType+'"]';return"club"!==e.favoriteType&&(t+='[data-favorite-id="'+e.favoriteId+'"]'),$(this.selectors.favorite+t)},showFavoriteError:function(e){var t=i.FavoriteError;try{t=JSON.parse(e.responseText).Error}catch(e){}this.showWarningMessage(t)},showWarningMessage:function(t){e.pubsub.publish(e.constants.EVENTS.SHOW_WARNING,t)},toggleFavoriteForAllWithType:function(e,t){this.getTheClones(e).each(function(n,i){var s,o=$(i),r=o.data("favorite-remove-unfavorited");if(r&&!t){var a=o.closest(r);a.trigger("beforeRemove"),a.remove()}else{var c=t;"club"===e.favoriteType&&(c=o.data("favorite-id").toString()===e.favoriteId?c:!c),s=o.data("favorite-class"),o.toggleClass(s,c)}})},toggleFavoritingForAllWithType:function(e,t){this.getTheClones(e).toggleClass("favoriting",t)},triggerSuccessfulFavoriteAction:function(t){this.getFavourites(),this.updateFavouriteElements(),e.pubsub.publish("favorite:successful",t)}})}),MECCA.define("core/components/modal/modal.all",["app","core/components/_component"],function(e,t){"use strict";return t.extend({bindAll:["showModal","hideModal","showConfirmation","showWarning"],modal:null,initialize:function(){this.addListeners()},addListeners:function(){e.pubsub.subscribe(e.constants.EVENTS.SHOW_MODAL,this.showModal),e.pubsub.subscribe(e.constants.EVENTS.SHOW_CONFIRMATION,this.showConfirmation),e.pubsub.subscribe(e.constants.EVENTS.SHOW_WARNING,this.showWarning)},attachEvents:function(){this.modal.one(e.constants.EVENTS.SHOWN_MODAL,this.onShownHandler),this.modal.one(e.constants.EVENTS.HIDDEN_MODAL,this.removeItselfFromDOM)},removeItselfFromDOM:function(){e.pubsub.publish(e.constants.EVENTS.HIDDEN_MODAL),$(this).remove()},getModalTemplate:function(e){var t=['<div id="meccaModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">','<div class="modal-dialog">','<div class="modal-content">'];return e.addInnerWrapper&&t.push('<div class="modal-content-inner">'),e.close&&t.push('<button type="button" class="btn modal-close" data-dismiss="modal"><i class="sprite '+(e.closeClass||" shared-close")+'"></i></button>'),(e.prompt||e.close)&&t.push('<div class="modal-prompt">'+(e.prompt||"")+"</div>"),e.addInnerWrapper&&t.push("</div>"),t.push("</div></div></div>"),t.join("")},hideModal:function(e){this.modal&&this.modal.removeClass(e&&"fade").modal("hide")},showModal:function(t,n){var i={},s=n;!_.isObject(n)||n instanceof jQuery||(i=n,s=i.$el),this.hideModal(!0),this.modal=$(this.getModalTemplate(i)),window.currentModal=this.modal,this.attachEvents();var o=i.addInnerWrapper?".modal-content-inner":".modal-content";this.modal.find(o).append(s).end().addClass(i.className).on("click",i.stopPropagation?e.utils.stopPropagation:e.utils.noop).appendTo("body").modal(),$(document).trigger("modal:shown",[s,i.loginForm])},showConfirmation:function(t,n){var i=this.hideModal,s=n.html,o=_.defaults(n.yes||{},{cta:"Yes",callback:e.utils.noop}),r=_.defaults(n.no||{},{cta:"No"}),a=n.remember,c=$(['<div class="pad-5">',s||'<h4 class="c-h4 mar-btm-15">'+(n.message||"")+"</h4>",'<button type="button" class="btn btn-light mar-right-10" data-dismiss="modal">'+r.cta+"</button>",'<button type="button" class="js-confirmation-yes btn">'+o.cta+"</button>",a?'<label class="l-block mar-top-15">':"",a?'<input type="checkbox" class="js-confirmation-remember l-mar-0 mar-right-10 l-v-align-mid" />':"",a?'<span class="l-v-align-mid">Don\'t show me this message again</span>':"",a?"</label>":"","</div>"].join("")),u=function(){return c.find(".js-confirmation-remember").prop("checked")},l=_.wrap(o.callback,function(e){e(u()),i()});c.one("click",".js-confirmation-yes",l),this.showModal("",{$el:c,className:n.className,stopPropagation:!0})},showWarning:function(e,t){var n="",i="",s=!1;_.isObject(t)?(n=t.message,i=t.details):"ApiUnauthorized"===t?(i="You have been logged out. Please log in and try again.",s=!0):n=t,this.showModal("",['<div class="pad-5">','<h4 class="c-h4 mar-btm-15">'+(n||"Oops...")+"</h4>",i?'<div class="mar-btm-15">'+i+"</div>":"",'<button type="button" class="btn" data-dismiss="modal"',s?'onclick="window.location.reload(true)"':"",">Got it</button>","</div>"].join(""))},onShownHandler:function(){e.pubsub.publish(e.constants.EVENTS.SHOWN_MODAL),$(this).placeholder()}})}),function(e,t){"use strict";function n(e,t,n){return setTimeout(c(e,n),t)}function i(e,t,n){return!!Array.isArray(e)&&(s(e,n[t],n),!0)}function s(e,n,i){var s,o;if(e)if(e.forEach)e.forEach(n,i);else if(e.length!==t)for(s=0,o=e.length;s<o;s++)n.call(i,e[s],s,e);else for(s in e)e.hasOwnProperty(s)&&n.call(i,e[s],s,e)}function o(e,n,i){for(var s=_.keys(n),o=0,r=s.length;o<r;o++)(!i||i&&e[s[o]]===t)&&(e[s[o]]=n[s[o]]);return e}function r(e,t){return o(e,t,!0)}function a(e,t,n){var i,s=t.prototype;if(Object.create)i=e.prototype=Object.create(s),i.constructor=e;else{o(e,t);var r=function(){this.constructor=e};r.prototype=s,i=e.prototype=new r}n&&o(i,n),i._super=s}function c(e,t){return function(){return e.apply(t,arguments)}}function u(e,n){return typeof e==se?e.apply(n?n[0]||t:t,n):e}function l(e,n){return e===t?n:e}function h(e,t,n){s(m(t),function(t){e.addEventListener(t,n,!1)})}function d(e,t,n){s(m(t),function(t){e.removeEventListener(t,n,!1)})}function p(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function f(e,t){return e.indexOf(t)>-1}function m(e){return e.trim().split(/\s+/g)}function v(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0,s=e.length;i<s;i++)if(n&&e[i][n]==t||!n&&e[i]===t)return i;return-1}function g(e){return Array.prototype.slice.call(e,0)}function E(e,t){for(var n=[],i=[],s=0,o=e.length;s<o;s++){var r=t?e[s][t]:e[s];v(i,r)<0&&n.push(e[s]),i[s]=r}return n}function S(e,n){for(var i,s,o=n[0].toUpperCase()+n.slice(1),r=0,a=ie.length;r<a;r++)if(i=ie[r],(s=i?i+o:n)in e)return s;return t}function C(){return ae++}function b(t,n){var i=this;this.manager=t,this.callback=n,this.domHandler=function(e){u(i.manager.options.enable,[i.manager])&&i.handler(e)},this.evEl&&h(this.manager.element,this.evEl,this.domHandler),this.evWin&&h(e,this.evWin,this.domHandler)}function T(e){return new(le?F:he?N:ue?H:D)(e,w)}function w(e,t,n){var i=n.pointers.length,s=n.changedPointers.length,o=t&pe&&i-s==0,r=t&(fe|me)&&i-s==0;n.isFirst=o,n.isFinal=r,o&&(e.session={}),n.eventType=t,A(e,n),e.emit("hammer.input",n),e.recognize(n)}function A(e,t){var n=e.session,i=t.pointers,s=i.length;n.firstInput||(n.firstInput=k(t)),s>1&&!n.firstMultiple?n.firstMultiple=k(t):1===s&&(n.firstMultiple=!1);var o=n.firstInput,r=n.firstMultiple,a=r?r.center:o.center,c=I(i);t.timeStamp=re(),t.deltaTime=t.timeStamp-o.timeStamp,t.deltaX=c.x-a.x,t.deltaY=c.y-a.y,t.center=c,t.angle=L(a,c),t.distance=O(a,c),t.offsetDirection=M(t.deltaX,t.deltaY),t.scale=r?R(r.pointers,i):1,t.rotation=r?x(r.pointers,i):0;var u=e.element;p(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u,y(n,t)}function y(e,n){var i=e.lastInterval;i||(i=e.lastInterval=k(n));var s,o,r,a,c=n.timeStamp-i.timeStamp;if(c>de||i.velocity===t){var u=i.deltaX-n.deltaX,l=i.deltaY-n.deltaY,h=$(c,u,l);o=h.x,r=h.y,s=Math.max(h.x,h.y),a=M(u,l)}else s=i.velocity,o=i.velocityX,r=i.velocityY,a=i.direction;n.velocity=s,n.velocityX=o,n.velocityY=r,n.direction=a}function k(e){for(var t=[],n=0;n<e.pointers.length;n++)t[n]={clientX:oe(e.pointers[n].clientX),clientY:oe(e.pointers[n].clientY)};return{timeStamp:re(),pointers:t,center:I(t),deltaX:e.deltaX,deltaY:e.deltaY}}function I(e){var t=e.length;if(1===t)return{x:oe(e[0].clientX),y:oe(e[0].clientY)};for(var n=0,i=0,s=0;s<t;s++)n+=e[s].clientX,i+=e[s].clientY;return{x:oe(n/t),y:oe(i/t)}}function $(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}}function M(e,t){return e===t?ve:Math.abs(e)>=Math.abs(t)?e>0?ge:Ee:t>0?Se:Ce}function O(e,t,n){n||(n=we);var i=t[n[0]]-e[n[0]],s=t[n[1]]-e[n[1]];return Math.sqrt(i*i+s*s)}function L(e,t,n){n||(n=we);var i=t[n[0]]-e[n[0]],s=t[n[1]]-e[n[1]];return 180*Math.atan2(s,i)/Math.PI}function x(e,t){return L(t[1],t[0],Ae)-L(e[1],e[0],Ae)}function R(e,t){return O(t[0],t[1],Ae)/O(e[0],e[1],Ae)}function D(){this.evEl=ke,this.evWin=Ie,this.allow=!0,this.pressed=!1,b.apply(this,arguments)}function F(){this.evEl=Oe,this.evWin=Le,b.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evEl=Re,this.targetIds={},b.apply(this,arguments)}function P(e,t){var n,i,s=t.targetIds,o=g(e.targetTouches),r=g(e.changedTouches),a=[];if("touchstart"==e.type)for(n=0,i=o.length;n<i;n++)s[o[n].identifier]=!0;for(n=0,i=r.length;n<i;n++)s[r[n].identifier]&&a.push(r[n]),"touchend"!=e.type&&"touchcancel"!=e.type||delete s[r[n].identifier];return[E(o.concat(a),"identifier"),a]}function H(){b.apply(this,arguments);var e=c(this.handler,this);this.touch=new N(this.manager,e),this.mouse=new D(this.manager,e)}function B(e,t){this.manager=e,this.set(t)}function j(e){if(f(e,He))return He;var t=f(e,Be),n=f(e,je);return t&&n?Be+" "+je:t||n?t?Be:je:f(e,Pe)?Pe:Ne}function U(e){this.id=C(),this.manager=null,this.options=r(e||{},this.defaults),this.options.enable=l(this.options.enable,!0),this.state=Ue,this.simultaneous={},this.requireFail=[]}function G(e){return e&Ye?"cancel":e&ze?"end":e&We?"move":e&Ge?"start":""}function W(e){return e==Ce?"down":e==Se?"up":e==ge?"left":e==Ee?"right":""}function z(e,t){var n=t.manager;return n?n.get(e):e}function V(){U.apply(this,arguments)}function Y(){V.apply(this,arguments),this.pX=null,this.pY=null}function q(){V.apply(this,arguments)}function K(){U.apply(this,arguments),this._timer=null,this._input=null}function X(){V.apply(this,arguments)}function Q(){V.apply(this,arguments)}function J(){U.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Z(e,t){return t=t||{},t.recognizers=l(t.recognizers,Z.defaults.preset),new ee(e,t)}function ee(e,t){t=t||{},this.options=r(t,Z.defaults),this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=T(this),this.touchAction=new B(this,this.options.touchAction),te(this,!0),s(t.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[2])},this)}function te(e,t){var n=e.element,i=e.options.cssProps;s(i,function(e,i){n.style[S(n.style,i)]=t?e:""});var o=t&&function(){return!1};"none"==i.userSelect&&(n.onselectstart=o),"none"==i.userDrag&&(n.ondragstart=o)}function ne(e,t){var n=document.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}var ie=["","webkit","moz","MS","ms","o"],se="function",oe=Math.round,re=Date.now,ae=1,ce=/mobile|tablet|ip(ad|hone|od)|android/i,ue="ontouchstart"in e,le=S(e,"PointerEvent")!==t,he=ue&&ce.test(navigator.userAgent),de=25,pe=1,fe=4,me=8,ve=1,ge=2,Ee=4,Se=8,Ce=16,be=ge|Ee,_e=Se|Ce,Te=be|_e,we=["x","y"],Ae=["clientX","clientY"];b.prototype={handler:function(){},destroy:function(){this.elEvents&&d(this.manager.element,this.elEvents,this.domHandler),this.winEvents&&d(e,this.winEvents,this.domHandler)}};var ye={mousedown:pe,mousemove:2,mouseup:fe,mouseout:me},ke="mousedown",Ie="mousemove mouseout mouseup";a(D,b,{handler:function(e){var t=ye[e.type];if(t&pe&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=fe),this.pressed&&this.allow){var n=e.relatedTarget||e.toElement||e.target;"mouseout"==e.type&&"HTML"!=n.nodeName&&(t=2),t&(fe|me)&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e})}}});var $e={pointerdown:pe,pointermove:2,pointerup:fe,pointercancel:me,pointerout:me},Me={2:"touch",3:"pen",4:"mouse",5:"kinect"},Oe="pointerdown",Le="pointermove pointerout pointerup pointercancel";e.MSPointerEvent&&(Oe="MSPointerDown",Le="MSPointerMove MSPointerOut MSPointerUp MSPointerCancel"),a(F,b,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),s=$e[i],o=Me[e.pointerType]||e.pointerType,r=e.relatedTarget||e.toElement||e.target;"pointerout"==i&&"HTML"!=r.nodeName&&(s=2),s&pe&&(0===e.button||"touch"==o)?t.push(e):s&(fe|me)&&(n=!0);var a=v(t,e.pointerId,"pointerId");a<0||(t[a]=e,this.callback(this.manager,s,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(a,1))}});var xe={touchstart:pe,touchmove:2,touchend:fe,touchcancel:me},Re="touchstart touchmove touchend touchcancel";a(N,b,{handler:function(e){var t=P(e,this);this.callback(this.manager,xe[e.type],{pointers:t[0],changedPointers:t[1],pointerType:"touch",srcEvent:e})}}),a(H,b,{handler:function(e,t,n){var i="touch"==n.pointerType,s="mouse"==n.pointerType;if(i)this.mouse.allow=!1;else if(s&&!this.mouse.allow)return;t&(fe|me)&&(this.mouse.allow=!0),this.callback(e,t,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var De=S(document.body.style,"touchAction"),Fe=De!==t,Ne="auto",Pe="manipulation",He="none",Be="pan-x",je="pan-y";B.prototype={set:function(e){"compute"==e&&(e=this.compute()),Fe&&(this.manager.element.style[De]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return s(this.manager.recognizers,function(t){u(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),j(e.join(" "))},preventDefaults:function(e){if(!Fe){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,s=f(i,He),o=f(i,je),r=f(i,Be);return s||o&&r||o&&n&be||r&&n&_e?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ue=1,Ge=2,We=4,ze=8,Ve=ze,Ye=16;U.prototype={defaults:{},set:function(e){return o(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(i(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=z(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return i(e,"dropRecognizeWith",this)?this:(e=z(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(i(e,"requireFailure",this))return this;var t=this.requireFail;return e=z(e,this),-1===v(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(i(e,"dropRequireFailure",this))return this;e=z(e,this);var t=v(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){this.manager.emit(this.options.event,e),this.manager.emit(this.options.event+G(this.state),e)},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;e++)if(!(this.requireFail[e].state&(32|Ue)))return!1;return!0},recognize:function(e){var t=o({},e);if(!u(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(Ve|Ye|32)&&(this.state=Ue),this.state=this.process(t),this.state&(Ge|We|ze|Ye)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},a(V,U,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&(Ge|We),s=this.attrTest(e);return i&&(n&me||!s)?t|Ye:i||s?n&fe?t|ze:t&Ge?t|We:Ge:32}}),a(Y,V,{defaults:{event:"pan",threshold:10,pointers:1,direction:Te},getTouchAction:function(){var e=this.options.direction;if(e===Te)return[He];var t=[];return e&be&&t.push(je),e&_e&&t.push(Be),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,s=e.direction,o=e.deltaX,r=e.deltaY;return s&t.direction||(t.direction&be?(s=0===o?ve:o<0?ge:Ee,n=o!=this.pX,i=Math.abs(e.deltaX)):(s=0===r?ve:r<0?Se:Ce,n=r!=this.pY,i=Math.abs(e.deltaY))),e.direction=s,n&&i>t.threshold&&s&t.direction},attrTest:function(e){return V.prototype.attrTest.call(this,e)&&(this.state&Ge||!(this.state&Ge)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY,this._super.emit.call(this,e);var t=W(e.direction);t&&this.manager.emit(this.options.event+t,e)}}),a(q,V,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[He]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Ge)},emit:function(e){if(this._super.emit.call(this,e),1!==e.scale){var t=e.scale<1?"in":"out";this.manager.emit(this.options.event+t,e)}}}),a(K,U,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Ne]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,s=e.distance<t.threshold,o=e.deltaTime>t.time;return this._input=e,!s||!i||e.eventType&(fe|me)&&!o?this.reset():e.eventType&pe&&(this.reset(),this._timer=n(function(){this.state=Ve,this.tryEmit()},t.time,this)),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state===Ve&&(this._input.timeStamp=re(),this.manager.emit(this.options.event,this._input))}}),a(X,V,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[He]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Ge)}}),a(Q,V,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:be|_e,pointers:1},getTouchAction:function(){return Y.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(be|_e)?t=e.velocity:n&be?t=e.velocityX:n&_e&&(t=e.velocityY),this._super.attrTest.call(this,e)&&n&e.direction&&t>this.options.velocity&&e.eventType&fe},emit:function(e){this.manager.emit(this.options.event,e);var t=W(e.direction);t&&this.manager.emit(this.options.event+t,e)}}),a(J,U,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,s=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&pe&&0===this.count)return this._failTimeout();if(s&&o&&i){if(e.eventType!=fe)return this._failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||O(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,a&&r?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=n(function(){this.state=Ve,this.tryEmit()},t.interval,this),Ge):Ve}return 32},_failTimeout:function(){return this._timer=n(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ve&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Z.VERSION="2.0.0",Z.defaults={domEvents:!1,touchAction:"compute",enable:!0,preset:[[X,{enable:!1}],[q,{enable:!1},["rotate"]],[Q,{direction:be}],[Y,{direction:be},["swipe"]],[J],[J,{event:"doubletap",taps:2},["tap"]],[K]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ee.prototype={set:function(e){return o(this.options,e),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){if(!this.session.stopped){this.touchAction.preventDefaults(e);var t,n=this.session,i=n.curRecognizer;(!i||i&&i.state&Ve)&&(i=n.curRecognizer=null);for(var s=0,o=this.recognizers.length;s<o;s++)t=this.recognizers[s],2===this.session.stopped||i&&t!=i&&!t.canRecognizeWith(i)?t.reset():t.recognize(e),!i&&t.state&(Ge|We|ze)&&(i=n.curRecognizer=t)}},get:function(e){if(e instanceof U)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(i(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(i(e,"remove",this))return this;var t=this.recognizers;return e=this.get(e),t.splice(v(t,e),1),this.touchAction.update(),this},on:function(e,t){var n=this.handlers;return s(m(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){var n=this.handlers;return s(m(e),function(e){t?n[e].splice(v(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&ne(e,t);var n=this.handlers[e];if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0,s=n.length;i<s;i++)n[i](t)}},destroy:function(){this.element&&te(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},o(Z,{INPUT_START:pe,INPUT_MOVE:2,INPUT_END:fe,INPUT_CANCEL:me,STATE_POSSIBLE:Ue,STATE_BEGAN:Ge,STATE_CHANGED:We,STATE_ENDED:ze,STATE_RECOGNIZED:Ve,STATE_CANCELLED:Ye,STATE_FAILED:32,DIRECTION_NONE:ve,DIRECTION_LEFT:ge,DIRECTION_RIGHT:Ee,DIRECTION_UP:Se,DIRECTION_DOWN:Ce,DIRECTION_HORIZONTAL:be,DIRECTION_VERTICAL:_e,DIRECTION_ALL:Te,Manager:ee,Input:b,TouchAction:B,Recognizer:U,AttrRecognizer:V,Tap:J,Pan:Y,Swipe:Q,Pinch:q,Rotate:X,Press:K,on:h,off:d,each:s,merge:r,extend:o,inherit:a,bindFn:c,prefixed:S}),
"function"==typeof MECCA.define&&MECCA.define.amd?MECCA.define("vendor/hammer",[],function(){return Z}):"undefined"!=typeof module&&module.exports?module.exports=Z:e.Hammer=Z}(window),MECCA.define("core/components/menu/menu.touch",["app","core/components/_component","vendor/hammer"],function(e,t,n){"use strict";return t.extend({type:e.constants.BREAKPOINT_LABELS.TOUCH,bindAll:["showMenu","hideMenu","fixHeight"],onEnter:function(){this.ensureHammer(),this.cacheElements(),this.addListeners(),this.createResizeThrottle(),this.fixHeight()},onExit:function(){this.removeListeners(),this.fixHeight(!1),this.isOpened()||this.toggleResizeListener(!1)},ensureHammer:function(){this.hammer||(this.hammer=new n(document.body))},createResizeThrottle:function(){this.resizeThrottle=_.debounce(_.bind(this.fixHeight,this),30)},cacheElements:function(){this.$pageWrapper=$(".js-page-wrapper"),this.$menuButton=$(".js-menu"),this.$fadeScreen=$(".js-fade-screen"),this.$html=$(".js"),this.$headerNavigation=$(".js-header-navigation"),this.$headerNavigationContainer=$(".js-header-navigation-container"),this.$window=$(window)},addListeners:function(){this.$headerNavigationContainer.on("shown.bs.collapse.component:menu:touch",this.fixHeight),this.$headerNavigationContainer.on("hidden.bs.collapse.component:menu:touch",this.fixHeight),this.$fadeScreen.on("click.component:menu:touch",this.hideMenu),this.$menuButton.on("click.component:menu:touch",this.showMenu),this.hammer.on("swipeleft",this.hideMenu)},removeListeners:function(){this.$headerNavigationContainer.off(".component:menu:touch"),this.$fadeScreen.off(".component:menu:touch"),this.$menuButton.off(".component:menu:touch"),this.hammer.off("swipeleft")},showMenu:function(){this.toggleMenu(!0)},hideMenu:function(){this.toggleMenu(!1)},toggleMenu:function(t){e.utils.isStateValid(t)||(t=!this.isOpened()),this.$fadeScreen.toggleClass("show",t),this.$html.toggleClass("opened",t),this.fixHeight(t),this.toggleResizeListener(t)},isOpened:function(){return this.$html.hasClass("opened")},fixHeight:function(t){e.responsive.isTouchMode()?e.utils.isStateValid(t)||(t=this.isOpened()):t=!1;var n=t?this.getMenuHeight():"";this.$pageWrapper.css("min-height",n),this.$headerNavigation.css("height",n)},toggleResizeListener:function(e){var t=e?"on":"off";this.$window[t]("resize.component:menu:touch",this.resizeThrottle)},getMenuHeight:function(){return Math.max(this.$headerNavigationContainer.outerHeight(),this.$window.height())}})}),MECCA.define("core/components/menu/menu.desktop.track",["app","core/components/_component"],function(e,t){"use strict";return t.extend({cacheElements:function(){this.$menuItem=this.getItems(),this.$menu=$(".menubar")},proccedTracking:function(t){this.$target=$(t.currentTarget),this.delayInterval=_.delay(this.onDelayComplete,e.constants.SHOW_DELAY,this)},clearTracking:function(){clearTimeout(this.delayInterval)},onDelayComplete:function(e){e.doAction()},getItems:function(){var e=_.filter($(".menubar-item"),function(e){return $(e).find(".menubar-submenu").length>0});return $(e)}})}),MECCA.define("core/components/menu/menu.desktop.track.close",["app","core/components/menu/menu.desktop.track"],function(e,t){"use strict";return t.extend({initialize:function(e){this.$trackedEl=e,this.cacheElements(),this.addEventListeners()},addEventListeners:function(){this.$trackedEl.on("mouseenter.component:menu:desktop:track:close",_.bind(this.clearTracking,this)),this.$trackedEl.on("mouseleave.component:menu:desktop:track:close",_.bind(this.proccedTracking,this))},removeEventListeners:function(){this.$trackedEl.off(".component:menu:desktop:track:close")},doAction:function(){this.$trackedEl.trigger(e.constants.EVENTS.MENU_CLOSE),this.removeEventListeners()}})}),MECCA.define("core/components/menu/menu.desktop.track.open",["app","core/components/_component","core/components/menu/menu.desktop.track","core/components/menu/menu.desktop.track.close"],function(e,t,n,i){"use strict";return n.extend({trackClose:null,initialize:function(){this.cacheElements(),this.addEventListeners()},addEventListeners:function(){this.$menuItem.on("mouseenter.component:menu:desktop:track:open",_.bind(this.proccedTracking,this)),this.$menuItem.on("mouseleave.component:menu:desktop:track:open",_.bind(this.clearTracking,this))},removeEventListeners:function(){this.$menuItem.off(".component:menu:desktop:track:open")},doAction:function(){this.isOpened()||(this.$target.trigger(e.constants.EVENTS.MENU_OPEN),new i(this.$target))},isOpened:function(){return this.$target.hasClass("opened")}})}),MECCA.define("core/components/menu/menu.desktop.keyboard",["app","core/components/_component"],function(e,t){"use strict";return t.extend({initialize:function(){this.cacheElements(),this.addEventListeners()},cacheElements:function(){this.$page=$(".js-page-wrapper"),this.$menu=$(".js-menubar"),this.$menuList=this.$menu.children(),this.initMap()},initMap:function(){this.map={};for(var e=this.$menu.children(),t=e.length,n=0;n<t;n++){var i=$(e.get(n)),s=$(i.find(".js-menubar-item-target").get(0));if(s){var o=i.find(".js-menubar-submenu-item"),r=o.length;this.map[this.mapAttr(s,"parent",""+n)]={el:i,hasSubmenu:r>0},this.mapAttr(s,"index",""+n,!0);for(var a=0;a<r;a++)i=$(o.get(a)),(s=$(i.find(".js-menubar-item-target").get(0)))&&(this.mapAttr(s,"parent",""+n),this.mapAttr(s,"index",n+"-"+a,!0))}}},mapAttr:function(e,t,n,i){return e.attr(t,n),i&&(this.map[t+"-"+n]=e),n},addEventListeners:function(){this.$page.on("mousemove.component:menu:desktop:keqboard",_.bind(this.onPageMousemoveHandler,this)),this.$menu.on("focusin.component:menu:desktop:keqboard",_.bind(this.onMenuFocusinHandler,this)),this.$menu.on("blur.component:menu:desktop:keqboard",".js-menubar-item-target",_.bind(this.onMenuBlurHandler,this)),this.$menu.on("keyup.component:menu:desktop:keqboard",_.bind(this.onMenuKeyupHandler,this))},removeEventListeners:function(){this.$menu.off(".component:menu:desktop:keqboard"),this.$page.off(".component:menu:desktop:keqboard")},onPageMousemoveHandler:function(e){var t=$(e.target);if(t.hasClass("js-menubar-item-target")){var n=t.attr("parent"),i=this.getParent(n);this.openedMenuItem&&this.openedMenuItem!==i?this.addCloseTimeout():clearTimeout(this.closeTimeout)}else this.addCloseTimeout()},onMenuFocusinHandler:function(){clearTimeout(this.closeTimeout)},onMenuBlurHandler:function(){this.addCloseTimeout()},onMenuKeyupHandler:function(t){var n=$(t.target),i=n.attr("index"),s=!1,o=!1,r=this.getLevelByPosition(i);switch(t.which){case e.constants.ARROW_RIGHT_KEYCODE:case e.constants.ARROW_LEFT_KEYCODE:s=!0;break;case e.constants.ARROW_UP_KEYCODE:case e.constants.ARROW_DOWN_KEYCODE:o=!0}if(s||o){var a=i.split("-"),c=parseInt(_.last(a),10);if(s){var u=n.closest("ul").children().length;c=this.getCursor(t.which,u,c),i=2===r?_.first(a)+"-"+c:""+c}else o&&(i=2===r?_.first(a):i+"-0");n=this.getItemTergetByPosition(i)||n,n.focus()}/(9|37|39|38|40)/.test(t.which)&&this.open(n)},onCloseTimeoutComplete:function(t){t.openedMenuItem&&t.openedMenuItem.hasClass("opened")&&t.openedMenuItem.trigger(e.constants.EVENTS.MENU_CLOSE)},addCloseTimeout:function(){this.openedMenuItem&&(clearTimeout(this.closeTimeout),this.closeTimeout=_.delay(this.onCloseTimeoutComplete,e.constants.SHOW_DELAY,this))},open:function(t){this.$menuList.each(_.bind(function(t,n){$(n).hasClass("opened")&&$(n).trigger(e.constants.EVENTS.MENU_CLOSE)},this));var n=t.attr("parent"),i=this.getParent(n);this.openedMenuItem=i,this.openedMenuItem&&this.hasSubmenu(n)&&this.openedMenuItem.trigger(e.constants.EVENTS.MENU_OPEN),clearTimeout(this.closeTimeout)},getCursor:function(t,n,i){return e.constants.ARROW_LEFT_KEYCODE===t?(i+n-1)%n:(i+1)%n},getItemTergetByPosition:function(e){return this.map["index-"+e]},getLevelByPosition:function(e){return e.split("-").length},getParent:function(e){return this.map[e].el},hasSubmenu:function(e){return this.map[e].hasSubmenu}})}),MECCA.define("core/components/menu/menu.desktop.track.handler",["app","core/components/_component"],function(e,t){"use strict";return t.extend({type:e.constants.BREAKPOINT_LABELS.DESKTOP,action:null,actionTimeout:null,onEnter:function(){this.cacheElements(),this.addEventListeners()},onExit:function(){this.removeEventListeners()},cacheElements:function(){this.$menuActivated=$(".menubar-item.activated"),this.$menuItem=$(".menubar-item"),this.$menuList=$(".js-menubar").children()},addEventListeners:function(){this.$menuItem.on(e.constants.EVENTS.MENU_OPEN+".component:menu:desktop:track:handler",_.bind(this.onOpenMenuHandler,this)),this.$menuItem.on(e.constants.EVENTS.MENU_CLOSE+".component:menu:desktop:track:handler",_.bind(this.onCloseMenuHandler,this))},removeEventListeners:function(){this.$menuItem.off(".component:menu:desktop:track:handler")},addTimeout:function(){clearTimeout(this.actionTimeout),this.actionTimeout=_.delay(this.onActionTimeoutComplete,1,this)},onActionTimeoutComplete:function(t){clearTimeout(t.actionTimeout),t.action===e.constants.EVENTS.MENU_CLOSE?t.hasOpenedMenu()||t.$menuActivated.removeClass("hide"):t.action===e.constants.EVENTS.MENU_OPEN&&t.hasOpenedMenu()&&t.$menuActivated.addClass("hide")},hasOpenedMenu:function(){var e=!1;return this.$menuList.each(_.bind(function(t,n){if($(n).hasClass("opened"))return void(e=!0)},e)),e},onOpenMenuHandler:function(e){$(e.target).hasClass("activated")||($(e.target).addClass("opened"),this.action=e.type,this.addTimeout())},onCloseMenuHandler:function(e){$(e.target).hasClass("activated")||($(e.target).removeClass("opened"),this.action=e.type,this.addTimeout())}})}),MECCA.define("core/components/menu/menu.desktop",["app","core/components/_component","core/components/menu/menu.desktop.track.open","core/components/menu/menu.desktop.keyboard","core/components/menu/menu.desktop.track.handler"],function(e,t,n,i,s){"use strict";return t.extend({type:e.constants.BREAKPOINT_LABELS.DESKTOP,onEnter:function(){this.trackHandler=new s,this.trackOpen=new n,this.keyboardManager=new i},onExit:function(){this.trackOpen.removeEventListeners(),this.keyboardManager.removeEventListeners(),this.trackHandler.removeEventListeners()}})}),MECCA.define("core/components/menu/menu.export",["app","core/components/_component.export","core/components/menu/menu.touch","core/components/menu/menu.desktop"],function(e,t,n,i){"use strict";return t.extend({components:[n,i]})}),MECCA.define("core/components/balance/balance.all",["app","core/components/_component","vendor/swiper","vendor/cookies","services"],function(e,t,n,i,s){"use strict";return t.extend({bindAll:["updateBalance"],initialize:function(){this.cacheElements(),this.defineProperties(),this.initSlider(),e.constants.LOGGED_IN_HARD&&(this.isBalanceHidden()?this.$balanceInfo.addClass("balance-info-hidden"):this.$balanceInfo.removeClass("balance-info-hidden"),this.isBalanceHidden()?this.$balanceDrop.addClass("hide"):this.$balanceDrop.removeClass("hide"))},balanceRefreshClickHandler:function(){s.balanceService.isFetching()||(this.toggleFetching(!0),s.balanceService.get({context:this}).done(this.onRefreshDone).complete(this.onRefreshComplete))},cacheElements:function(){this.$balanceGroup=$(".js-balance-group"),this.$balanceInfo=$(".js-balance-info"),this.$balanceString=$(".js-balance-string"),this.$balanceSwiperContainer=$(".js-balance-swiper-container"),this.$balanceButton=$(".js-balance-button"),this.$balanceRefreshButton=$(".js-balance-refresh"),this.$balanceInfoAmount=$(".js-balance-info-amount"),this.$balanceHidden=$(".js-balance-hidden"),this.$balanceDrop=$(".balance-dropdown-trigger"),this.$balanceWallet=$(".js-balance-widget")},defineProperties:function(){this.createBalanceModel(),this.balanceSwipeInterval=1e3*this.$balanceGroup.data("balance-swipe-interval")||5e3},createBalanceModel:function(e){this.balanceModel=_.defaults(e||{Balance:this.$balanceGroup.data("user-balance"),Bonus:this.$balanceGroup.data("user-bonus")},{DisplayProperty:"Balance"})},initSlider:function(){this.canCreateSlider()&&(this.fixAmountWidth(),this.removeHardHideClass(),this.createSlider(),this.runBalanceSwiping())},removeHardHideClass:function(){this.$balanceSwiperContainer.removeClass("balance-info-hidden")},createSlider:function(){this.balanceSlider=new n(".js-balance-swiper-container",{initialSlide:this.getInitialSlide(),slidesPerView:"auto",onSlideClick:_.bind(this.onSlideClick,this),onTouchEnd:_.bind(this.changeBalanceState,this),onSlideChangeEnd:_.bind(this.changeBalanceState,this),roundLengths:!0,DOMAnimation:!1})},onRefreshComplete:function(){this.toggleFetching(!1)},onRefreshDone:function(e){this.createBalanceModel(_.extend(this.balanceModel,e)),this.isBalanceHidden()||this.updateBalance(!0)},getDisplayBalance:function(e){return{type:e,label:e+":",amount:this.balanceModel[e]}},getCurrentDisplayBalance:function(){var e=this.balanceModel.DisplayProperty;return e?this.getDisplayBalance(e):this.getNextDisplayBalance()},getNextDisplayBalance:function(){var e=this.balanceModel,t=!!e.Bonus,n="Balance"===e.DisplayProperty,i=n&&t?"Bonus":"Balance";return this.getDisplayBalance(i)},updateBalance:function(e){var t=e?this.getCurrentDisplayBalance():this.getNextDisplayBalance();this.$balanceString.html(t.label),this.$balanceInfoAmount.html(t.amount),this.balanceModel.DisplayProperty=t.type,this.fixAmountWidth(),this.runBalanceSwiping()},runBalanceSwiping:function(){this.stopBalanceSwiping(),this.isBalanceHidden()||(this.balanceSwipingTimeout=_.delay(this.updateBalance,this.balanceSwipeInterval))},stopBalanceSwiping:function(){clearTimeout(this.balanceSwipingTimeout)},fixAmountWidth:function(){var t=_.max([this.$balanceInfoAmount.width(),this.$balanceHidden.width()]);this.$balanceInfo.width(t),e.pubsub.publish("balance.refresh-balance")},toggleFetching:function(e){this.$balanceRefreshButton.prop("disabled",e)},onSlideClick:function(e,t){this.isTargetAButton(t.target||t.srcElement)&&this.toggleSlides()},changeBalanceState:function(){this.isBalanceHidden()?this.$balanceInfo.addClass("balance-info-hidden"):this.$balanceInfo.removeClass("balance-info-hidden"),this.isBalanceHidden()?this.$balanceDrop.addClass("hide"):this.$balanceDrop.removeClass("hide"),this.$balanceWallet.removeClass("drop-active"),this.runBalanceSwiping(),this.saveBalanceState()},saveBalanceState:function(){this.isBalanceHidden()?i.set(this.getCookieName(),1,{expires:e.constants.MAX_COOKIE_EXPIRES_DATE}):i.expire(this.getCookieName())},isTargetAButton:function(e){var t=this.$balanceButton.get(0);return t===e||$.contains(t,e)},toggleSlides:function(){this.isBalanceHidden()?this.balanceSlider.swipePrev():this.balanceSlider.swipeNext()},canCreateSlider:function(){return e.constants.LOGGED_IN_HARD},getCookieName:function(){return e.constants.COOKIES.BALANCE_HIDDEN_COOKIE_NAME},getInitialSlide:function(){return this.isBalanceHidden(!0)?1:0},isBalanceHidden:function(e){return e?!!i.get(this.getCookieName()):!!this.balanceSlider.activeIndex}})}),MECCA.define("core/components/header/header.mobile",["app","core/components/_component"],function(e,t){"use strict";return t.extend({type:e.constants.BREAKPOINT_LABELS.MOBILE,bindAll:["collapseHandler"],onEnter:function(){this.cacheElements(),this.addListeners()},onExit:function(){this.removeListeners()},cacheElements:function(){this.$header=$(".js-header"),this.$accountForm=$(".js-account-form"),this.$accountButton=$(".js-account-button")},addListeners:function(){this.$header.on("show.bs.collapse.component:header:mobile",this.collapseHandler),this.$header.on("hide.bs.collapse.component:header:mobile",this.collapseHandler)},removeListeners:function(){this.$header.off(".component:header:mobile")},collapseHandler:function(e){var t="show"===e.type,n=t?"shared-account-reversed":"shared-account";this.$accountButton.children("i").removeClass("shared-account shared-account-reversed").addClass(n)}})}),MECCA.define("core/components/common/dropdown.base",["app","core/components/_component"],function(e,t){"use strict";return t.extend({bindAll:["onDropdownHideHandler","onDropdownShowHandler","onDropdownShownHandler","onClickDropdownHandler","onDropdownHiddenHandler"],initialize:function(){this.cacheElements(),this.addEventlisteners()},cacheElements:function(){},addEventlisteners:function(){},onClickDropdownHandler:function(t){$(t.target).closest(".js-open-in-popup").length||e.utils.stopPropagation(t)},onDropdownShowHandler:function(e){this.selectControlButton($(e.relatedTarget).parent(),!0)},onDropdownShownHandler:function(){this.$dropdown.on("click.bs.dropdown.component:header-controls-dropdown:all",this.onClickDropdownHandler)},onDropdownHideHandler:function(e){this.selectControlButton($(e.relatedTarget).parent(),!1)},onDropdownHiddenHandler:function(){this.$dropdown.off("click.bs.dropdown.component:header-controls-dropdown:all")},selectControlButton:function(e,t){t?e.addClass("selected"):e.removeClass("selected")}})}),MECCA.define("core/components/account/favourites/user-favourites.display.base",["app","core/components/_component"],function(e,t){"use strict";return t.extend({selectors:{swiperContainer:".js-favourites-swiper-container",favNavigation:".js-fav-navigation",favouritesSwiperSlide:".js-favourites-swiper-slide"},cacheElements:function(){this.$swiperContainer=$(this.selectors.swiperContainer),this.$favNavigation=$(this.selectors.favNavigation),this.timeouts=[]},addListeners:function(){this.favSuccessfulToken||(this.favSuccessfulToken=e.pubsub.subscribe("favorite:successful",this.onFavoriteSuccessful))},onFavoriteSuccessful:function(e,t){var n=this.$swiperContainer.find('[data-favorite-id="'+t.favoriteId+'"]'),i=n.closest(this.selectors.favouritesSwiperSlide);this.removeSlideWitnAnimation(i)},removeSlideWitnAnimation:function(e,t){var n=_.bind(this.removeSlide,this,e);e.fadeOut(t||500,n)},removeSlide:function(t){this.favouritesSwiper&&(this.storedIndex=this.favouritesSwiper.activeIndex,this.favouritesSwiper.removeSlide(t.data("index")),_.isEmpty(this.favouritesSwiper.slides)&&e.pubsub.publish("show.empty.favorites.event"))},removeListeners:function(){e.pubsub.unsubscribe(this.onFavoriteSuccessful),this.favSuccessfulToken=void 0},destroy:function(){this.clearTimeouts(),this.removeListeners(),this.favouritesSwiper&&(this.favouritesSwiper.destroy(),this.favouritesSwiper=null)},onSwiperInitHandler:function(){_.each(this.favouritesSwiper.slides,function(e,t){$(e).data("index",t)})},canInitSwiper:function(){return this.$swiperContainer.length},addTimeout:function(e){this.timeouts.push(e)},clearTimeouts:function(){_.each(this.timeouts,function(e){clearTimeout(e)}),this.timeouts=[]}})}),MECCA.define("core/components/account/favourites/user-favourites.desktop",["app","core/components/account/favourites/user-favourites.display.base","vendor/swiper"],function(e,t,n){"use strict";var i=t.prototype;return t.extend({type:e.constants.BREAKPOINT_LABELS.DESKTOP,bindAll:["initSwiper","navPrevHandler","navNextHandler","onSlideChangeEnd","onFavoriteSuccessful"],selectors:_.extend(i.selectors,{navNext:".js-fav-navigation .js-fav-navigation-next",navPrev:".js-fav-navigation .js-fav-navigation-prev",navNextBlock:".js-fav-navigation .js-fav-navigation-next-block",navPrevBlock:".js-fav-navigation .js-fav-navigation-prev-block",swiperWrapper:".js-favourites-swiper-wrapper",slide:".js-favourites-swiper-slide"}),onEnter:function(){this.cacheElements(),this.addListeners(),this.initSwiper()},onExit:function(){this.destroy()},cacheElements:function(){i.cacheElements.apply(this,arguments),this.$swiperWrapper=$(this.selectors.swiperWrapper),this.$navNext=$(this.selectors.navNext),this.$navNextBlock=$(this.selectors.navNextBlock),this.$navPrev=$(this.selectors.navPrev),this.$navPrevBlock=$(this.selectors.navPrevBlock),this.$window=$(window)},addListeners:function(){i.addListeners.apply(this,arguments),this.$navNext.on("click.component:user-favourites:desktop",this.navNextHandler),this.$navPrev.on("click.component:user-favourites:desktop",this.navPrevHandler)},removeListeners:function(){i.removeListeners.apply(this,arguments);var e=".component:user-favourites:desktop";this.$navNext.off(e),this.$navPrev.off(e),this.$window.off(e)},initSwiper:function(){this.canInitSwiper()&&(this.storedIndex=0,this.favouritesSwiper=new n(this.selectors.swiperContainer,{slidesPerView:"auto",calculateHeight:!0,freeMode:!0,simulateTouch:!1,autoResize:$.support.transition,onInit:_.bind(this.onSwiperInitHandler,this),onSwiperCreated:_.bind(this.onSwiperInitHandler,this)}),this.addResizeFix())},addResizeFix:function(){if(!$.support.transition){var e=_.debounce(_.bind(this.resizeFix,this),100);this.$window.on("resize.component:user-favourites:desktop",e)}},resizeFix:function(){this.favouritesSwiper&&this.favouritesSwiper.resizeFix()},navNextHandler:function(){var e=$(_.last(this.favouritesSwiper.visibleSlides)),t=e.data("index");this.swipeToWithTransition(t)},navPrevHandler:function(){var e=this.favouritesSwiper.visibleSlides,t=$(_.first(e)),n=t.data("index"),i=n-e.length+1;this.swipeToWithTransition(i<0?0:i)},onSwiperInitHandler:function(e){this.favouritesSwiper||(this.favouritesSwiper=e),i.onSwiperInitHandler.apply(this,arguments),this.swipeToWithTransition(this.storedIndex)},onSlideChangeEnd:function(){this.favouritesSwiper&&this.updateDisplayNavigation()},swipeToWithTransition:function(e){if($.support.transition){var t=$(this.favouritesSwiper.slides[e]),n=t.eq(0),i=this.favouritesSwiper.params.speed;n.one($.support.transition.end,this.onSlideChangeEnd),this.favouritesSwiper.swipeTo(e,i,!1),this.addTimeout(n.emulateTransitionEnd(i).data("transition-end-timeout"))}else this.favouritesSwiper.swipeTo(e,0,!1),this.onSlideChangeEnd()},updateDisplayNavigation:function(){this.$swiperWrapper.width()>this.$swiperContainer.width()?(this.$favNavigation.addClass("enabled"),this.canShowNext()?this.$navNextBlock.addClass("show"):this.$navNextBlock.removeClass("show"),this.canShowPrev()?this.$navPrevBlock.addClass("show"):this.$navPrevBlock.removeClass("show")):this.$favNavigation.removeClass("enabled")},canShowPrev:function(){return this.favouritesSwiper.getWrapperTranslate()<-1},canShowNext:function(){var e=this.favouritesSwiper.getWrapperTranslate(),t=this.$swiperWrapper.width()-this.$swiperContainer.width();return Math.abs(e)-Math.abs(t)<-1},canInitSwiper:function(){return this.$swiperContainer.length}})}),MECCA.define("core/components/account/favourites/user-favourites.touch",["app","core/components/account/favourites/user-favourites.display.base","vendor/swiper"],function(e,t,n){"use strict";return t.extend({type:e.constants.BREAKPOINT_LABELS.TOUCH,bindAll:["initSwiper","onFavoriteSuccessful","onSwiperInitHandler"],onEnter:function(){this.cacheElements(),this.addListeners(),this.initSwiper(),this.disableNavigation()},onExit:function(){this.destroy()},initSwiper:function(){this.canInitSwiper()&&(this.favouritesSwiper=new n(this.selectors.swiperContainer,{slidesPerView:"auto",calculateHeight:!0,freeModeFluid:!0,autoResize:!1,onInit:this.onSwiperInitHandler}))},disableNavigation:function(){this.$favNavigation.removeClass("enabled")}})});var zeus=zeus||{};MECCA.define("core/components/account/favourites/user-favourites.all",["app","core/components/_component","services"],function(e,t,n){"use strict";var i=e.constants.WARNING_MESSAGES;return t.extend({bindAll:["toggleLoading","unfavouriteClickHandler","renderEmptyState"],selectors:{favouritesTemplate:".js-user-favourites-template",container:".js-user-favourites-container-inner",loading:".js-user-favourites-container .js-loading-placeholder",unfavorite:".js-favourites-item .js-unfavorite-action",favorite:".js-favourites-item .js-favorite-action",link:".favorite-item",gmsLaunchedGame:".gms-launched-game",gmsPlayerId:"#gms-player-id",gmsGamingToken:"#gms-gaming-token"},initialize:function(){this.cacheElements(),this.addListeners(),this.defineProperties()},defineProperties:function(){this.service=n.userFavouritesService,this.favouritesTemplate=e.mixins.createTemplateFunction($(this.selectors.favouritesTemplate)),this.$gmsPlayerId.val()&&this.$gmsGamingToken.val()&&(this.gmsConfig={playerToken:this.$gmsGamingToken.val(),playerId:this.$gmsPlayerId.val()})},cacheElements:function(){this.$container=$(this.selectors.container),this.eventDispatcher=$(this),this.$loading=$(this.selectors.loading),this.$favouritesContainer=$(".js-user-favourites-container"),this.$favouritesEmptyMessage=$(".js-user-empty-favourites-text"),this.$favouritesEmptyImage=$(".js-user-empty-favourites-img"),this.$gmsPlayerId=$(this.selectors.gmsPlayerId),this.$gmsGamingToken=$(this.selectors.gmsGamingToken)},cacheFavouritesElements:function(){this.$favorite=$(this.selectors.favorite),this.$unfavorite=$(this.selectors.unfavorite),this.$gmsLaunchedGame=$(this.selectors.gmsLaunchedGame),this.$document=$(document.body)},addListeners:function(){e.pubsub.subscribe("show.empty.favorites.event",this.renderEmptyState)},addFavouriteListeners:function(){this.$favorite.on("click.component:user-favourites:all",this.unfavouriteClickHandler),this.$unfavorite.on("click.component:user-favourites:all",this.unfavouriteClickHandler),this.$gmsLaunchedGame.on("click",this.launchGMSGame.bind(this)),this.$document.on("click",this.selectors.link,this.linkClickHandler)},linkClickHandler:function(t){e.utils.preventDefault(t),e.utils.stopPropagation(t)},unfavouriteClickHandler:function(t){var n=$(t.currentTarget);e.pubsub.publish("custom.favorite.event",{type:n.data("favorite-type"),id:n.data("favorite-id").toString(),isFavorite:!0,isFavoriting:n.hasClass("favoriting")})},fetchData:function(){this.toggleLoading(!0),this.service.get({context:this}).done(this.onFetchDone).always(this.onFetchComplete).fail(this.onFetchFail)},onFetchDone:function(e){this.toggleLoading(!1);var t=this.getItemsFromResponse(e);this.isEmptyData(t)?this.renderEmptyState():(this.renderItems(t),this.eventDispatcher.trigger("favourites.data.loaded"),this.fixHeight())},getItemsFromResponse:function(e){var t=[];if(e){var n=this.getItemsGroupByAvailability(e.FavoritedGames),i=this.getItemsGroupByAvailability(e.FavoritedRooms);t=t.concat(this.sortItemsByTitle(n.available,"game")),t=t.concat(this.sortItemsByTitle(n.unavailable,"game")),t=t.concat(this.sortItemsByTitle(i.available,"room")),t=t.concat(this.sortItemsByTitle(i.unavailable,"room"))}return t},getItemsGroupByAvailability:function(e){return _.groupBy(e,function(e){return e.IsAvailable?"available":"unavailable"})},sortItemsByTitle:function(e,t){return e?_.sortBy(e,function(e){return e.type=t,e.Title}):[]},onFetchFail:function(){this.toggleLoading(!1),this.renderEmptyState()},renderEmptyState:function(){this.$favouritesContainer.addClass("empty"),this.$favouritesEmptyMessage.text(i.NoFavoritesMessage),this.$favouritesEmptyImage.css("background-image","url("+i.NoFavoritesMessageImage+")")},isEmptyData:function(e){return!e||!e.length},fixHeight:function(){e.mixins.runHeightFixerOnClosest(this.$container)},onFetchComplete:function(){this.toggleLoading(!1)},generateTemplate:function(t){return this.favouritesTemplate({renderLinkHelper:_.bind(e.mixins.renderLinkHelper,e.mixins),isNativeLaunched:function(e){return e&&e.Link&&"gms"!==e.Link.Link},items:t})},renderItems:function(e){this.$container.html(this.generateTemplate(e)),this.cacheFavouritesElements(),this.addFavouriteListeners()},reloadData:function(){this.removeItems(),this.fetchData()},removeItems:function(){this.$container.empty()},toggleLoading:function(e){this.$loading.toggleClass("l-none",!e),e&&this.$favouritesContainer.removeClass("empty")},launchGMSGame:function(e){var t=e.currentTarget,n={tableId:$(t).data("tableid"),softwareId:$(t).data("softwareid"),width:$(t).data("popup-width"),height:$(t).data("popup-height"),technology:$(t).data("technology")},i=this;this.getTokenAndId().done(function(e){i.checkGMSLaunchURL(e,n)}).fail(function(e){window.alert(e)})},getTokenAndId:function(){var e=$.Deferred();return this.gmsConfig?(e.resolve(this.gmsConfig),e):($.get(zeus.core.siteRoot+"api/Lobby/PlayerToken").success(function(t){t&&t.GameToken&&t.UserId?e.resolve(this.gmsConfig={playerToken:t.GameToken,playerId:t.UserId}):e.reject(new Error("Game token was not returned although API call was successful."))}).fail(function(){e.reject(new Error("Failed to fetch game token."))}),e)},checkGMSLaunchURL:function(e,t){e={PlayerId:e.playerId,PlayerToken:e.playerToken,Currency:"GBP",Channel:zeus.core.isMobile?"mobile":"desktop",Language:"EN",AutoLaunch:!1,IsDemo:!1,SourceUrl:"",SourceArea:"",TableId:t.tableId,Technology:zeus.core.isMobile?"HTML5":t.technology||"FLASH"};var n=this;this.getGMSLaunchURl(e,t.softwareId).done(function(e){wlzeus.gameLaunch.handler(e.launchUrl,function(e){window.open(e,"_blank",n.getPopupProperties({width:+t.width||void 0,height:+t.height||void 0,resizable:"yes"}))})}).fail(function(e){window.alert(e)})},getGMSLaunchURl:function(e,t){var n=document.querySelector('meta[name="csrf-token"]'),i=n?n.getAttribute("content"):"";return $.ajax({url:"/gamelaunch/v1/games/"+t.toString()+"/launch",type:"post",contentType:"application/json",data:JSON.stringify(e),headers:{"X-Correlation-Token":window.uuid.v4(),"X-Site-Code":"meccabingo.com","X-CSRF-Token":i}})},getPopupProperties:function(t){var n=_.defaults(t,e.constants.POPUP_PROPERTIES);return _.invoke(_.pairs(n),"join","=").join(",")}})}),MECCA.define("core/components/account/favourites/user-favourites.export",["app","core/components/_component.export","core/components/account/favourites/user-favourites.desktop","core/components/account/favourites/user-favourites.touch","core/components/account/favourites/user-favourites.all"],function(e,t,n,i,s){"use strict";var o=t.prototype;return t.extend({components:[n,i,s],getDisplayUserFavouritesDesktopInst:function(){return this._componentsInstances[0]||$.error("UserFavouritesExport: DisplayUserFavouritesDesktop is not instantiated")},getDisplayUserFavouritesTouchInst:function(){return this._componentsInstances[1]||$.error("UserFavouritesExport: DisplayUserFavouritesTouch is not instantiated")},getUserFavouritesAllInst:function(){return this._componentsInstances[2]||$.error("UserFavouritesExport: UserFavouritesAll is not instantiated")},initializeComponents:function(){o.initializeComponents.apply(this,arguments),this.favDisplayTouchInst=this.getDisplayUserFavouritesTouchInst(),this.favDisplayDesktopInst=this.getDisplayUserFavouritesDesktopInst(),this.favAllInst=this.getUserFavouritesAllInst(),this.afterInit()},afterInit:function(){var e=_.bind(this.reinitSwiper,this);this.favAllInst.eventDispatcher.on("favourites.data.loaded",e),this.favAllInst.fetchData()},reloadData:function(){this.favAllInst.reloadData()},reinitSwiper:function(){this.getCurrentDisplayInst().onEnter()},clearDisplayData:function(){this.getCurrentDisplayInst().destroy()},getCurrentDisplayInst:function(){return e.responsive.isTouchMode()?this.favDisplayTouchInst:this.favDisplayDesktopInst}})}),MECCA.define("core/components/header/header-controls-dropdown.all",["app","core/components/common/dropdown.base","core/components/account/favourites/user-favourites.export"],function(e,t,n){"use strict";return t.extend({cacheElements:function(){this.$dropdown=$(".js-header-controls-dropdown"),this.$dropdownAnchor=$(".js-header-content"),this.$favouritesDropdown=$(".js-header-favourites")},addEventlisteners:function(){this.$dropdown.on("click.bs.dropdown.component:header-controls-dropdown:all",this.onClickDropdownHandler),this.$dropdownAnchor.on("show.bs.dropdown.component:header-controls-dropdown:all",this.onDropdownShowHandler),this.$dropdownAnchor.on("shown.bs.dropdown.component:header-controls-dropdown:all",this.onDropdownShownHandler),this.$dropdownAnchor.on("hide.bs.dropdown.component:header-controls-dropdown:all",this.onDropdownHideHandler),this.$favouritesDropdown.on("shown.bs.dropdown.component:header-controls-dropdown:all",_.bind(this.initUserFavourites,this)),this.$favouritesDropdown.on("hide.bs.dropdown.component:header-controls-dropdown:all",_.bind(this.clearUserFavourites,this))},initUserFavourites:function(){
this.userFavouritesInst?this.userFavouritesInst.reloadData():this.userFavouritesInst=new n},clearUserFavourites:function(){this.userFavouritesInst&&this.userFavouritesInst.clearDisplayData()}})}),MECCA.define("core/components/search/search.all",["app","core/components/_component","services"],function(e,t,n){"use strict";return t.extend({bindAll:["boxWrapperClickHandler","searchInputHandler","searchFocusHandler","clearClickHandler","formSubmitHandler","triggerClickHandler","closeSearch"],namespace:".component:search.all",minSearchQueryLength:3,cache:{},initialize:function(){this.createSearchDebounce(),this.cacheElements(),this.addListeners(),this.createTemplates(),this.toggleClearButton(),this.makeACheck()},cacheElements:function(){this.$document=$(document),this.$closeCollapseOnSearch=$(".js-close-collapse-on-search"),this.$closeDropdownOnSearch=$(".js-close-dropdown-on-search"),this.$trigger=$(".js-search-trigger"),this.$form=$(".js-search-box"),this.$field=$(".js-search-field"),this.$clear=$(".js-search-field-clear"),this.$results=$(".js-search-results"),this.$container=$(".js-search-container"),this.$searchButton=$(".js-search-button"),this.$boxWrapper=$(".js-search-box-wrapper"),this.$emptyTemplate=$(".js-search-results-empty-template"),this.$hintTemplate=$(".js-search-results-hint-template"),this.$groupTemplate=$(".js-search-results-group-template")},addListeners:function(){this.$boxWrapper.on("click",this.boxWrapperClickHandler),this.$trigger.on("click",this.triggerClickHandler),this.$form.on("submit",this.formSubmitHandler),this.$field.on("focus",this.searchFocusHandler),this.$field.on("input propertychange",this.searchInputHandler),this.$clear.on("click",this.clearClickHandler),$(document).on("clearSearch",this.closeSearch)},formSubmitHandler:function(t){e.utils.preventDefault(t),this.search(),this.blurField()},triggerClickHandler:function(){this.toggleFocusState(),this.isSearchInFocus()&&this.focusOnField()},searchFocusHandler:function(){this.toggleFocusState(!0)},boxWrapperClickHandler:function(t){var n=$(t.target);n.closest(".js-open-in-popup").length||n.closest(".js-bingo-login").length||e.utils.stopPropagation(t)},searchInputHandler:function(){this.toggleClearButton(),this.searchDebounce()},clearClickHandler:function(){this.clearSearch(),this.abortSearch(),this.toggleClearButton(),this.focusOnField(),this.showSearchHint()},createSearchDebounce:function(){this.searchDebounce=_.debounce(this.search,300)},createTemplates:function(){this.emptyTemplate=e.mixins.createTemplateFunction(this.$emptyTemplate),this.hintTemplate=e.mixins.createTemplateFunction(this.$hintTemplate),this.groupTemplate=e.mixins.createTemplateFunction(this.$groupTemplate)},search:function(){this.canBeAutoSearched()?(this.abortSearch(),this.makeSearch()):this.showSearchHint()},toggleClearButton:function(){this.$clear.toggleClass("l-none",!this.getSearchQuery())},makeACheck:function(){this.$field.get(0)===document.activeElement&&this.focusOnField()},onSearchDone:function(e,t){this.cacheResponse(e,t),this.processSearchResponse(t)},onSearchFail:function(e,t){"abort"!==t&&this.showEmptyResults()},processSearchResponse:function(e){this.hasSearchResults(e)?this.showSearchResults(e):this.showEmptyResults()},getCachedResponse:function(e){return this.cache[e]},cacheResponse:function(e,t){this.cache[e]=t},showSearchResults:function(e){this.$results.html(this.groupTemplate({data:this.prepareDataForTemplate(e)}))},showSearchHint:function(){this.$results.html(this.hintTemplate())},showEmptyResults:function(){this.$results.html(this.emptyTemplate())},makeSearch:function(){var e=this.getSearchQuery(),t=this.getCachedResponse(e);t?this.processSearchResponse(t):(this.request=this.requestSearchResults(e),this.request.done(_.bind(this.onSearchDone,this,e)).fail(this.onSearchFail))},requestSearchResults:function(e){return n.searchService.get({context:this,data:{query:e}})},canBeAutoSearched:function(){return this.getSearchQuery().length>=this.minSearchQueryLength},hasSearchResults:function(e){return _.flatten(_.values(_.pick(e||{},"BingoRooms","SlotsAndGames"))).length>0},prepareDataForTemplate:function(t){return _.compact(_.map(this.getGroupsForTemplate(),function(n,i){var s=t[i];return s&&s.length?{type:i,label:n,items:_.map(s,function(n){return{title:e.mixins.highlightStr(n.Title,t.SearchParts),image:n.ItemImageUrl,info:n.InfoUrl,link:n.ActionLink}})}:null}))},getGroupsForTemplate:function(){return{SlotsAndGames:"Slots & games",BingoRooms:"Bingo rooms"}},toggleFocusClass:function(e){this.$container.toggleClass("search-container-focus",e),this.$searchButton.toggleClass("search-container-focus",e)},toggleFocusState:function(t){e.utils.isStateValid(t)||(t=!this.isSearchInFocus()),t?(this.closeCollapses(),this.closeDropdowns(),this.addDocumentListeners(),this.toggleFocusClass(t)):this.closeSearch()},focusOnField:function(){this.$field.focus()},blurField:function(){this.$field.blur()},isSearchInFocus:function(){return this.$container.hasClass("search-container-focus")&&this.$searchButton.hasClass("search-container-focus")},closeCollapses:function(){this.$closeCollapseOnSearch.each(_.bind(this.closeCollapse,this))},closeDropdowns:function(){this.$closeDropdownOnSearch.each(_.bind(this.closeDropdown,this))},closeCollapse:function(e,t){var n=$(t);if(!n.hasClass("collapsed")){var i=n.attr("href")||n.data("target"),s=$(i);n.addClass("collapsed"),s.removeClass("in").height(0)}},closeDropdown:function(e,t){var n,i,s=$(t),o=s.parent(),r=o.hasClass("selected");r&&(n=s.data("target"),i=$(n),o.removeClass("selected"),i.removeClass("open"))},addDocumentListeners:function(){_.delay(_.bind(function(){this.$document.one("click"+this.namespace,this.closeSearch),this.$document.one("show.bs.dropdown"+this.namespace,this.closeSearch)},this))},removeDocumentListeners:function(){this.$document.off(this.namespace)},clearSearch:function(){this.$field.val("")},abortSearch:function(){this.request&&this.request.abort()},closeSearch:function(){this.clearSearch(),this.abortSearch(),this.showSearchHint(),this.blurField(),this.toggleClearButton(),this.toggleFocusClass(!1),this.removeDocumentListeners()},getSearchQuery:function(){return $.trim(this.$field.val())}})}),MECCA.define("core/components/cookie-message/cookie-message.all",["app","core/components/_component","vendor/cookies"],function(e,t,n){"use strict";return t.extend({bindAll:["acceptCookies","onAcceptCookiesDone","makeAcceptCookieRequest"],initialize:function(){this.cacheElements(),this.addListeners(),void 0===n.get("CookiesPolicy")&&this.$cookieBlock.collapse("show")},cacheElements:function(){this.$cookieBlock=$(".js-cookie-message-block"),this.$acceptBtn=$(".js-cookie-got-it-btn"),this.$closeBtn=$(".js-cookie-close-btn")},addListeners:function(){this.$acceptBtn.on("click",this.acceptCookies),this.$closeBtn.on("click",this.onAcceptCookiesDone)},acceptCookies:function(){this.makeAcceptCookieRequest()},makeAcceptCookieRequest:function(){const e=new Date;e.setFullYear(e.getFullYear()+1),n.set("CookiesPolicy",JSON.stringify({IsPolicyAccepted:"true"}),{expires:e}),this.onAcceptCookiesDone()},onAcceptCookiesDone:function(){this.$cookieBlock.collapse("hide")}})}),MECCA.define("core/components/header/header.export",["app","core/components/_component.export","core/components/common/common.all","core/components/common/session-caretaker.all","core/components/common/favorite.all","core/components/modal/modal.all","core/components/menu/menu.export","core/components/balance/balance.all","core/components/header/header.mobile","core/components/header/header-controls-dropdown.all","core/components/search/search.all","core/components/cookie-message/cookie-message.all"],function(e,t,n,i,s,o,r,a,c,u,l,h){"use strict";return t.extend({components:[n,i,s,o,r,a,c,u,l,h]})}),MECCA.require(["core/components/header/header.export"],function(e){"use strict";new e}),MECCA.define("core/components/header/main",function(){});